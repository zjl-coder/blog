<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="generator" content="VuePress 2.0.0-beta.48">
    <style>
      :root {
        --c-bg: #fff;
      }
      html.dark {
        --c-bg: #22272e;
      }
      html, body {
        background-color: var(--c-bg);
      }
    </style>
    <script>
      const userMode = localStorage.getItem('vuepress-color-scheme');
			const systemDarkMode = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;
			if (userMode === 'dark' || (userMode !== 'light' && systemDarkMode)) {
				document.documentElement.classList.toggle('dark', true);
			}
    </script>
    <title>i18next | 风时雨</title><meta name="description" content="风时雨博客">
    <link rel="modulepreload" href="/blog/assets/app.c4af5a84.js"><link rel="modulepreload" href="/blog/assets/i18next.html.01b280f5.js"><link rel="modulepreload" href="/blog/assets/i18next.html.998fec3e.js"><link rel="prefetch" href="/blog/assets/index.html.11fbca88.js"><link rel="prefetch" href="/blog/assets/tool.html.9009e8c8.js"><link rel="prefetch" href="/blog/assets/index.html.f510a7ee.js"><link rel="prefetch" href="/blog/assets/sort.html.739958eb.js"><link rel="prefetch" href="/blog/assets/index.html.fc1c779c.js"><link rel="prefetch" href="/blog/assets/index.html.9fa7603d.js"><link rel="prefetch" href="/blog/assets/hot.html.bbf378d4.js"><link rel="prefetch" href="/blog/assets/index.html.803dc37f.js"><link rel="prefetch" href="/blog/assets/question1.html.b803b03d.js"><link rel="prefetch" href="/blog/assets/url.html.1c2c8f6b.js"><link rel="prefetch" href="/blog/assets/dns.html.10de04dd.js"><link rel="prefetch" href="/blog/assets/index.html.ec0e105b.js"><link rel="prefetch" href="/blog/assets/csrf.html.d2cb9c8e.js"><link rel="prefetch" href="/blog/assets/csv.html.bc1803f1.js"><link rel="prefetch" href="/blog/assets/index.html.e291da1c.js"><link rel="prefetch" href="/blog/assets/service.html.a5a5981a.js"><link rel="prefetch" href="/blog/assets/index.html.47c56ba7.js"><link rel="prefetch" href="/blog/assets/1.html.675ff234.js"><link rel="prefetch" href="/blog/assets/index.html.5ecad37f.js"><link rel="prefetch" href="/blog/assets/animation.html.10c38d03.js"><link rel="prefetch" href="/blog/assets/bfc.html.f63e1290.js"><link rel="prefetch" href="/blog/assets/bigf.html.58b50a02.js"><link rel="prefetch" href="/blog/assets/index.html.f6dba59d.js"><link rel="prefetch" href="/blog/assets/inline-block.html.ceaaab62.js"><link rel="prefetch" href="/blog/assets/rem.html.fcb8b191.js"><link rel="prefetch" href="/blog/assets/ast.html.9954ef99.js"><link rel="prefetch" href="/blog/assets/babel.html.ff383a08.js"><link rel="prefetch" href="/blog/assets/engineering.html.2b2d9769.js"><link rel="prefetch" href="/blog/assets/error-monitor.html.e584c450.js"><link rel="prefetch" href="/blog/assets/es6toes5.html.60a2c132.js"><link rel="prefetch" href="/blog/assets/git.html.c03bc32e.js"><link rel="prefetch" href="/blog/assets/hmr.html.3ea0ac3a.js"><link rel="prefetch" href="/blog/assets/index.html.18857df6.js"><link rel="prefetch" href="/blog/assets/npm-dangerous-act.html.582697cb.js"><link rel="prefetch" href="/blog/assets/optimize.html.e62fbd0e.js"><link rel="prefetch" href="/blog/assets/performance-monitor.html.c00d0e5d.js"><link rel="prefetch" href="/blog/assets/performance.html.823a2c80.js"><link rel="prefetch" href="/blog/assets/record.html.498ac1f4.js"><link rel="prefetch" href="/blog/assets/web.html.41d573ac.js"><link rel="prefetch" href="/blog/assets/webpack-loader.html.89c4ce80.js"><link rel="prefetch" href="/blog/assets/webpack-plugin.html.ed3b326e.js"><link rel="prefetch" href="/blog/assets/webpack.html.ebc69ca1.js"><link rel="prefetch" href="/blog/assets/async.html.1cacfc49.js"><link rel="prefetch" href="/blog/assets/bwbb.html.7808ca5d.js"><link rel="prefetch" href="/blog/assets/click.html.8a4d589a.js"><link rel="prefetch" href="/blog/assets/cross-terminal.html.5f1e4307.js"><link rel="prefetch" href="/blog/assets/curry-partial.html.6eb34ed8.js"><link rel="prefetch" href="/blog/assets/d-ts.html.21f847e0.js"><link rel="prefetch" href="/blog/assets/error.html.6ca0325e.js"><link rel="prefetch" href="/blog/assets/index.html.0af9788f.js"><link rel="prefetch" href="/blog/assets/promise.html.67a5266d.js"><link rel="prefetch" href="/blog/assets/search-params.html.14f090c7.js"><link rel="prefetch" href="/blog/assets/threejs.html.e8c41f23.js"><link rel="prefetch" href="/blog/assets/closure-trap.html.75baa21c.js"><link rel="prefetch" href="/blog/assets/index.html.f60e8251.js"><link rel="prefetch" href="/blog/assets/npm-link-bug.html.bb7db8d6.js"><link rel="prefetch" href="/blog/assets/react-0.html.43b4a2d4.js"><link rel="prefetch" href="/blog/assets/uncontrolled-components.html.e4909426.js"><link rel="prefetch" href="/blog/assets/index.html.351dd38c.js"><link rel="prefetch" href="/blog/assets/leader.html.f5ae21c3.js"><link rel="prefetch" href="/blog/assets/dart-and-runtime.html.aec76dc8.js"><link rel="prefetch" href="/blog/assets/index.html.2ce1203d.js"><link rel="prefetch" href="/blog/assets/index.html.dd3a1c2d.js"><link rel="prefetch" href="/blog/assets/connection.html.2b94ae9f.js"><link rel="prefetch" href="/blog/assets/http.html.acea879f.js"><link rel="prefetch" href="/blog/assets/index.html.0ac8988b.js"><link rel="prefetch" href="/blog/assets/index.html.8bab6f51.js"><link rel="prefetch" href="/blog/assets/shell.html.da97e690.js"><link rel="prefetch" href="/blog/assets/index.html.516c8c7f.js"><link rel="prefetch" href="/blog/assets/index.html.93a57d63.js"><link rel="prefetch" href="/blog/assets/nginx.html.af1a50fc.js"><link rel="prefetch" href="/blog/assets/buffer.html.1805e245.js"><link rel="prefetch" href="/blog/assets/http.html.a00e0283.js"><link rel="prefetch" href="/blog/assets/index.html.56dc498b.js"><link rel="prefetch" href="/blog/assets/router.html.fbfaa2aa.js"><link rel="prefetch" href="/blog/assets/stream.html.3f68037f.js"><link rel="prefetch" href="/blog/assets/index.html.1784f4ac.js"><link rel="prefetch" href="/blog/assets/process-thread.html.135dbcf2.js"><link rel="prefetch" href="/blog/assets/1.html.968eb009.js"><link rel="prefetch" href="/blog/assets/10.html.bc3fc248.js"><link rel="prefetch" href="/blog/assets/11.html.f8267625.js"><link rel="prefetch" href="/blog/assets/2.html.2e573c13.js"><link rel="prefetch" href="/blog/assets/3.html.cfd754de.js"><link rel="prefetch" href="/blog/assets/4.html.6884ad93.js"><link rel="prefetch" href="/blog/assets/5.html.7a026533.js"><link rel="prefetch" href="/blog/assets/6.html.ddd3498a.js"><link rel="prefetch" href="/blog/assets/7.html.adac3c38.js"><link rel="prefetch" href="/blog/assets/8.html.e279e965.js"><link rel="prefetch" href="/blog/assets/9.html.d55b9cdf.js"><link rel="prefetch" href="/blog/assets/index.html.637e52cf.js"><link rel="prefetch" href="/blog/assets/404.html.b4c6daf6.js"><link rel="prefetch" href="/blog/assets/index.html.859d3411.js"><link rel="prefetch" href="/blog/assets/tool.html.d12358e8.js"><link rel="prefetch" href="/blog/assets/index.html.8020a36a.js"><link rel="prefetch" href="/blog/assets/sort.html.1f6c45fd.js"><link rel="prefetch" href="/blog/assets/index.html.14372211.js"><link rel="prefetch" href="/blog/assets/index.html.fe3425a8.js"><link rel="prefetch" href="/blog/assets/hot.html.04ff0c13.js"><link rel="prefetch" href="/blog/assets/index.html.8759fd98.js"><link rel="prefetch" href="/blog/assets/question1.html.bfbd2c9f.js"><link rel="prefetch" href="/blog/assets/url.html.db4e06b5.js"><link rel="prefetch" href="/blog/assets/dns.html.22959dfd.js"><link rel="prefetch" href="/blog/assets/index.html.37f49198.js"><link rel="prefetch" href="/blog/assets/csrf.html.83c4a66f.js"><link rel="prefetch" href="/blog/assets/csv.html.70b6a12a.js"><link rel="prefetch" href="/blog/assets/index.html.ce2a9240.js"><link rel="prefetch" href="/blog/assets/service.html.47796d58.js"><link rel="prefetch" href="/blog/assets/index.html.27ba3d0b.js"><link rel="prefetch" href="/blog/assets/1.html.42f94f1d.js"><link rel="prefetch" href="/blog/assets/index.html.0b982e53.js"><link rel="prefetch" href="/blog/assets/animation.html.cf2f861b.js"><link rel="prefetch" href="/blog/assets/bfc.html.c242f085.js"><link rel="prefetch" href="/blog/assets/bigf.html.1aa79a91.js"><link rel="prefetch" href="/blog/assets/index.html.58d6952c.js"><link rel="prefetch" href="/blog/assets/inline-block.html.ee8e8392.js"><link rel="prefetch" href="/blog/assets/rem.html.6cab8e78.js"><link rel="prefetch" href="/blog/assets/ast.html.ce70505d.js"><link rel="prefetch" href="/blog/assets/babel.html.c3b1b638.js"><link rel="prefetch" href="/blog/assets/engineering.html.996429a6.js"><link rel="prefetch" href="/blog/assets/error-monitor.html.d919607a.js"><link rel="prefetch" href="/blog/assets/es6toes5.html.c652d66b.js"><link rel="prefetch" href="/blog/assets/git.html.d9ba553e.js"><link rel="prefetch" href="/blog/assets/hmr.html.af693df3.js"><link rel="prefetch" href="/blog/assets/index.html.d736df21.js"><link rel="prefetch" href="/blog/assets/npm-dangerous-act.html.7d97c5c5.js"><link rel="prefetch" href="/blog/assets/optimize.html.8ca46781.js"><link rel="prefetch" href="/blog/assets/performance-monitor.html.ec13192e.js"><link rel="prefetch" href="/blog/assets/performance.html.7f22d602.js"><link rel="prefetch" href="/blog/assets/record.html.d9a99ac2.js"><link rel="prefetch" href="/blog/assets/web.html.c5577ecd.js"><link rel="prefetch" href="/blog/assets/webpack-loader.html.f184ccc9.js"><link rel="prefetch" href="/blog/assets/webpack-plugin.html.eb519f46.js"><link rel="prefetch" href="/blog/assets/webpack.html.205bbce4.js"><link rel="prefetch" href="/blog/assets/async.html.37d1bb21.js"><link rel="prefetch" href="/blog/assets/bwbb.html.390a8c47.js"><link rel="prefetch" href="/blog/assets/click.html.405ddf81.js"><link rel="prefetch" href="/blog/assets/cross-terminal.html.6ffdda96.js"><link rel="prefetch" href="/blog/assets/curry-partial.html.e2cb635a.js"><link rel="prefetch" href="/blog/assets/d-ts.html.99d99fcb.js"><link rel="prefetch" href="/blog/assets/error.html.ac42eee8.js"><link rel="prefetch" href="/blog/assets/index.html.f5100062.js"><link rel="prefetch" href="/blog/assets/promise.html.f4262944.js"><link rel="prefetch" href="/blog/assets/search-params.html.19fc93f2.js"><link rel="prefetch" href="/blog/assets/threejs.html.e9622e67.js"><link rel="prefetch" href="/blog/assets/closure-trap.html.e319771b.js"><link rel="prefetch" href="/blog/assets/index.html.b48c9dc0.js"><link rel="prefetch" href="/blog/assets/npm-link-bug.html.847c7ac4.js"><link rel="prefetch" href="/blog/assets/react-0.html.efd55527.js"><link rel="prefetch" href="/blog/assets/uncontrolled-components.html.324ad575.js"><link rel="prefetch" href="/blog/assets/index.html.0920965d.js"><link rel="prefetch" href="/blog/assets/leader.html.c7b31b69.js"><link rel="prefetch" href="/blog/assets/dart-and-runtime.html.06d867d7.js"><link rel="prefetch" href="/blog/assets/index.html.e214cf25.js"><link rel="prefetch" href="/blog/assets/index.html.9daec48f.js"><link rel="prefetch" href="/blog/assets/connection.html.a6d278ec.js"><link rel="prefetch" href="/blog/assets/http.html.88823d98.js"><link rel="prefetch" href="/blog/assets/index.html.8b792c77.js"><link rel="prefetch" href="/blog/assets/index.html.1ac22a16.js"><link rel="prefetch" href="/blog/assets/shell.html.bc81b945.js"><link rel="prefetch" href="/blog/assets/index.html.2294df62.js"><link rel="prefetch" href="/blog/assets/index.html.ff38105b.js"><link rel="prefetch" href="/blog/assets/nginx.html.828c7ff1.js"><link rel="prefetch" href="/blog/assets/buffer.html.f6fbc16b.js"><link rel="prefetch" href="/blog/assets/http.html.5f324125.js"><link rel="prefetch" href="/blog/assets/index.html.c6b44aec.js"><link rel="prefetch" href="/blog/assets/router.html.c5702eac.js"><link rel="prefetch" href="/blog/assets/stream.html.09221edb.js"><link rel="prefetch" href="/blog/assets/index.html.6ba90908.js"><link rel="prefetch" href="/blog/assets/process-thread.html.2145214a.js"><link rel="prefetch" href="/blog/assets/1.html.d735aea0.js"><link rel="prefetch" href="/blog/assets/10.html.d20e9db2.js"><link rel="prefetch" href="/blog/assets/11.html.385f0bf9.js"><link rel="prefetch" href="/blog/assets/2.html.1511d33c.js"><link rel="prefetch" href="/blog/assets/3.html.1b6646e9.js"><link rel="prefetch" href="/blog/assets/4.html.4fd09a60.js"><link rel="prefetch" href="/blog/assets/5.html.dbe94916.js"><link rel="prefetch" href="/blog/assets/6.html.663f8808.js"><link rel="prefetch" href="/blog/assets/7.html.7312ef41.js"><link rel="prefetch" href="/blog/assets/8.html.1873cc1b.js"><link rel="prefetch" href="/blog/assets/9.html.0eea6a58.js"><link rel="prefetch" href="/blog/assets/index.html.d7c45dca.js"><link rel="prefetch" href="/blog/assets/404.html.81d24888.js"><link rel="prefetch" href="/blog/assets/404.0f686f87.js"><link rel="prefetch" href="/blog/assets/Layout.3d8d688f.js"><link rel="prefetch" href="/blog/assets/Crypto.5c6980f7.js"><link rel="prefetch" href="/blog/assets/Mind.0a7760d5.js"><link rel="prefetch" href="/blog/assets/Office.6349892f.js"><link rel="prefetch" href="/blog/assets/Pdf.f340c69e.js"><link rel="prefetch" href="/blog/assets/Te.e9db31d3.js"><link rel="prefetch" href="/blog/assets/TitleList.e759ccd1.js">
    <link rel="stylesheet" href="/blog/assets/style.bcf418b4.css">
  </head>
  <body>
    <div id="app"><!--[--><div class="theme-container"><!--[--><header class="navbar"><div class="toggle-sidebar-button" title="toggle sidebar" aria-expanded="false" role="button" tabindex="0"><div class="icon" aria-hidden="true"><span></span><span></span><span></span></div></div><span><a href="/blog/" class=""><!----><span class="site-name">风时雨</span></a></span><div class="navbar-items-wrapper" style=""><!--[--><!--]--><nav class="navbar-items can-hide"><!--[--><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="风雨夜航"><span class="title">风雨夜航</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="风雨夜航"><span class="title">风雨夜航</span><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a href="/blog/front/" class="router-link-active" aria-label="前端"><!--[--><!--]--> 前端 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/blog/server/" class="" aria-label="服务端"><!--[--><!--]--> 服务端 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/blog/network/" class="" aria-label="网络"><!--[--><!--]--> 网络 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/blog/app/" class="" aria-label="应用端"><!--[--><!--]--> 应用端 <!--[--><!--]--></a></li><!--]--></ul></div></div><div class="navbar-item"><a href="/blog/safe/" class="" aria-label="安全"><!--[--><!--]--> 安全 <!--[--><!--]--></a></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="面试题"><span class="title">面试题</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="面试题"><span class="title">面试题</span><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a href="/blog/interview_questions/" class="" aria-label="八股文"><!--[--><!--]--> 八股文 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a class="external-link" href="https://zjl-coder.github.io/design-pattern/" rel="noopener noreferrer" target="_blank" aria-label="设计模式"><!--[--><!--]--> 设计模式 <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/blog/algorithm/" class="" aria-label="算法"><!--[--><!--]--> 算法 <!--[--><!--]--></a></li><!--]--></ul></div></div><div class="navbar-item"><a href="/blog/tool.md" class="" aria-label="工具"><!--[--><!--]--> 工具 <!--[--><!--]--></a></div><!--]--></nav><!--[--><!--]--><button class="toggle-color-mode-button" title="toggle color mode"><svg style="" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M16 12.005a4 4 0 1 1-4 4a4.005 4.005 0 0 1 4-4m0-2a6 6 0 1 0 6 6a6 6 0 0 0-6-6z" fill="currentColor"></path><path d="M5.394 6.813l1.414-1.415l3.506 3.506L8.9 10.318z" fill="currentColor"></path><path d="M2 15.005h5v2H2z" fill="currentColor"></path><path d="M5.394 25.197L8.9 21.691l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 25.005h2v5h-2z" fill="currentColor"></path><path d="M21.687 23.106l1.414-1.415l3.506 3.506l-1.414 1.414z" fill="currentColor"></path><path d="M25 15.005h5v2h-5z" fill="currentColor"></path><path d="M21.687 8.904l3.506-3.506l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 2.005h2v5h-2z" fill="currentColor"></path></svg><svg style="display:none;" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M13.502 5.414a15.075 15.075 0 0 0 11.594 18.194a11.113 11.113 0 0 1-7.975 3.39c-.138 0-.278.005-.418 0a11.094 11.094 0 0 1-3.2-21.584M14.98 3a1.002 1.002 0 0 0-.175.016a13.096 13.096 0 0 0 1.825 25.981c.164.006.328 0 .49 0a13.072 13.072 0 0 0 10.703-5.555a1.01 1.01 0 0 0-.783-1.565A13.08 13.08 0 0 1 15.89 4.38A1.015 1.015 0 0 0 14.98 3z" fill="currentColor"></path></svg></button><form class="search-box" role="search"><input type="search" placeholder="搜索" autocomplete="off" spellcheck="false" value><!----></form></div></header><!--]--><div class="sidebar-mask"></div><!--[--><aside class="sidebar"><nav class="navbar-items"><!--[--><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="风雨夜航"><span class="title">风雨夜航</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="风雨夜航"><span class="title">风雨夜航</span><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a href="/blog/front/" class="router-link-active" aria-label="前端"><!--[--><!--]--> 前端 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/blog/server/" class="" aria-label="服务端"><!--[--><!--]--> 服务端 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/blog/network/" class="" aria-label="网络"><!--[--><!--]--> 网络 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/blog/app/" class="" aria-label="应用端"><!--[--><!--]--> 应用端 <!--[--><!--]--></a></li><!--]--></ul></div></div><div class="navbar-item"><a href="/blog/safe/" class="" aria-label="安全"><!--[--><!--]--> 安全 <!--[--><!--]--></a></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="面试题"><span class="title">面试题</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="面试题"><span class="title">面试题</span><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a href="/blog/interview_questions/" class="" aria-label="八股文"><!--[--><!--]--> 八股文 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a class="external-link" href="https://zjl-coder.github.io/design-pattern/" rel="noopener noreferrer" target="_blank" aria-label="设计模式"><!--[--><!--]--> 设计模式 <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/blog/algorithm/" class="" aria-label="算法"><!--[--><!--]--> 算法 <!--[--><!--]--></a></li><!--]--></ul></div></div><div class="navbar-item"><a href="/blog/tool.md" class="" aria-label="工具"><!--[--><!--]--> 工具 <!--[--><!--]--></a></div><!--]--></nav><!--[--><!--]--><ul class="sidebar-items"><!--[--><li><a href="/blog/front/" class="router-link-active sidebar-item sidebar-heading active" aria-label="前端"><!--[--><!--]--> 前端 <!--[--><!--]--></a><ul style="" class="sidebar-item-children"><!--[--><li><a href="/blog/front/work" class="sidebar-item" aria-label="职业"><!--[--><!--]--> 职业 <!--[--><!--]--></a><!----></li><li><a href="/blog/front/work/leader.md" class="sidebar-item" aria-label="前端Leader的任务"><!--[--><!--]--> 前端Leader的任务 <!--[--><!--]--></a><!----></li><li><a href="/blog/front/js" class="router-link-active sidebar-item active" aria-label="js"><!--[--><!--]--> js <!--[--><!--]--></a><ul style="" class="sidebar-item-children"><!--[--><li><a href="/blog/front/js/bwbb.md" class="sidebar-item" aria-label="browserify、webpack、babel、browserslist"><!--[--><!--]--> browserify、webpack、babel、browserslist <!--[--><!--]--></a><!----></li><li><a href="/blog/front/js/error.md" class="sidebar-item" aria-label="JavaScript中的Error类型"><!--[--><!--]--> JavaScript中的Error类型 <!--[--><!--]--></a><!----></li><li><a href="/blog/front/js/search-params.md" class="sidebar-item" aria-label="获取URL get参数"><!--[--><!--]--> 获取URL get参数 <!--[--><!--]--></a><!----></li><li><a href="/blog/front/js/promise.md" class="sidebar-item" aria-label="promise执行流程"><!--[--><!--]--> promise执行流程 <!--[--><!--]--></a><!----></li><li><a href="/blog/front/js/async.md" class="sidebar-item" aria-label="async await 执行流程"><!--[--><!--]--> async await 执行流程 <!--[--><!--]--></a><!----></li><li><a href="/blog/front/js/curry-partial.md" class="sidebar-item" aria-label="柯里化与局部应用"><!--[--><!--]--> 柯里化与局部应用 <!--[--><!--]--></a><!----></li><li><a href="/blog/front/js/click.md" class="sidebar-item" aria-label="click回调的异步与同步"><!--[--><!--]--> click回调的异步与同步 <!--[--><!--]--></a><!----></li><li><a href="/blog/front/js/threejs.md" class="sidebar-item" aria-label="three.js"><!--[--><!--]--> three.js <!--[--><!--]--></a><!----></li><li><a href="/blog/front/js/d-ts.md" class="sidebar-item" aria-label="*.d.ts全局类型声明"><!--[--><!--]--> *.d.ts全局类型声明 <!--[--><!--]--></a><!----></li><li><a href="/blog/front/js/cross-terminal.md" class="sidebar-item" aria-label="跨端技术的本质与现状"><!--[--><!--]--> 跨端技术的本质与现状 <!--[--><!--]--></a><!----></li><li><a href="/blog/front/js/i18next.md" class="sidebar-item active" aria-label="i18next"><!--[--><!--]--> i18next <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><a href="/blog/front/css" class="sidebar-item" aria-label="css"><!--[--><!--]--> css <!--[--><!--]--></a><ul style="" class="sidebar-item-children"><!--[--><li><a href="/blog/front/css/bfc.md" class="sidebar-item" aria-label="BFC、浮动float、clear"><!--[--><!--]--> BFC、浮动float、clear <!--[--><!--]--></a><!----></li><li><a href="/blog/front/css/bigf.md" class="sidebar-item" aria-label="BFC、IFC、GFC、FFC"><!--[--><!--]--> BFC、IFC、GFC、FFC <!--[--><!--]--></a><!----></li><li><a href="/blog/front/css/rem.md" class="sidebar-item" aria-label="rem移动端适配"><!--[--><!--]--> rem移动端适配 <!--[--><!--]--></a><!----></li><li><a href="/blog/front/css/animation.md" class="sidebar-item" aria-label="动画函数区分"><!--[--><!--]--> 动画函数区分 <!--[--><!--]--></a><!----></li><li><a href="/blog/front/css/inline-block.md" class="sidebar-item" aria-label="inline-block 元素下移现象"><!--[--><!--]--> inline-block 元素下移现象 <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><a href="/blog/front/react" class="sidebar-item" aria-label="react"><!--[--><!--]--> react <!--[--><!--]--></a><ul style="" class="sidebar-item-children"><!--[--><li><a href="/blog/front/react/uncontrolled-components.md" class="sidebar-item" aria-label="非受控组件 react"><!--[--><!--]--> 非受控组件 react <!--[--><!--]--></a><!----></li><li><a href="/blog/front/react/react-0.md" class="sidebar-item" aria-label="react渲染出0的问题"><!--[--><!--]--> react渲染出0的问题 <!--[--><!--]--></a><!----></li><li><a href="/blog/front/react/closure-trap.md" class="sidebar-item" aria-label="组件函数的闭包陷阱"><!--[--><!--]--> 组件函数的闭包陷阱 <!--[--><!--]--></a><!----></li><li><a href="/blog/front/react/npm-link-bug.md" class="sidebar-item" aria-label="npm link导致react库存在多实例"><!--[--><!--]--> npm link导致react库存在多实例 <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><a href="/blog/front/engineering" class="sidebar-item" aria-label="工程"><!--[--><!--]--> 工程 <!--[--><!--]--></a><ul style="" class="sidebar-item-children"><!--[--><li><a href="/blog/front/engineering/webpack.md" class="sidebar-item" aria-label="Webpack基本知识"><!--[--><!--]--> Webpack基本知识 <!--[--><!--]--></a><!----></li><li><a href="/blog/front/engineering/webpack-plugin.md" class="sidebar-item" aria-label="webpack plugin插件"><!--[--><!--]--> webpack plugin插件 <!--[--><!--]--></a><!----></li><li><a href="/blog/front/engineering/webpack-loader.md" class="sidebar-item" aria-label="webpack loader"><!--[--><!--]--> webpack loader <!--[--><!--]--></a><!----></li><li><a href="/blog/front/engineering/hmr.md" class="sidebar-item" aria-label="Webpack热更新原理解析"><!--[--><!--]--> Webpack热更新原理解析 <!--[--><!--]--></a><!----></li><li><a href="/blog/front/engineering/ast.md" class="sidebar-item" aria-label="AST抽象语法树"><!--[--><!--]--> AST抽象语法树 <!--[--><!--]--></a><!----></li><li><a href="/blog/front/engineering/babel.md" class="sidebar-item" aria-label="Babel基本知识"><!--[--><!--]--> Babel基本知识 <!--[--><!--]--></a><!----></li><li><a href="/blog/front/engineering/es6toes5.md" class="sidebar-item" aria-label="es6模块化代码转es5代码的模样"><!--[--><!--]--> es6模块化代码转es5代码的模样 <!--[--><!--]--></a><!----></li><li><a href="/blog/front/engineering/engineering.md" class="sidebar-item" aria-label="前端工程化"><!--[--><!--]--> 前端工程化 <!--[--><!--]--></a><!----></li><li><a href="/blog/front/engineering/error-monitor.md" class="sidebar-item" aria-label="前端错误监控"><!--[--><!--]--> 前端错误监控 <!--[--><!--]--></a><!----></li><li><a href="/blog/front/engineering/performance-monitor.md" class="sidebar-item" aria-label="前端性能监控"><!--[--><!--]--> 前端性能监控 <!--[--><!--]--></a><!----></li><li><a href="/blog/front/engineering/performance.md" class="sidebar-item" aria-label="性能指标"><!--[--><!--]--> 性能指标 <!--[--><!--]--></a><!----></li><li><a href="/blog/front/engineering/optimize.md" class="sidebar-item" aria-label="前端优化方案"><!--[--><!--]--> 前端优化方案 <!--[--><!--]--></a><!----></li><li><a href="/blog/front/engineering/web.md" class="sidebar-item" aria-label="对web项目的思考"><!--[--><!--]--> 对web项目的思考 <!--[--><!--]--></a><!----></li><li><a href="/blog/front/engineering/git.md" class="sidebar-item" aria-label="git常用命令"><!--[--><!--]--> git常用命令 <!--[--><!--]--></a><!----></li><li><a href="/blog/front/engineering/npm-dangerous-act.md" class="sidebar-item" aria-label="npm和yarn的危险行为"><!--[--><!--]--> npm和yarn的危险行为 <!--[--><!--]--></a><!----></li><li><a href="/blog/front/engineering/record.md" class="sidebar-item" aria-label="录屏与源码定位"><!--[--><!--]--> 录屏与源码定位 <!--[--><!--]--></a><!----></li><!--]--></ul></li><!--]--></ul></li><li><a href="/blog/server/" class="sidebar-item sidebar-heading" aria-label="服务端"><!--[--><!--]--> 服务端 <!--[--><!--]--></a><ul style="" class="sidebar-item-children"><!--[--><li><a href="/blog/server/node/" class="sidebar-item" aria-label="node"><!--[--><!--]--> node <!--[--><!--]--></a><ul style="" class="sidebar-item-children"><!--[--><li><a href="/blog/server/node/buffer.md" class="sidebar-item" aria-label="理解node buffer"><!--[--><!--]--> 理解node buffer <!--[--><!--]--></a><!----></li><li><a href="/blog/server/node/http.md" class="sidebar-item" aria-label="理解node http"><!--[--><!--]--> 理解node http <!--[--><!--]--></a><!----></li><li><a href="/blog/server/node/router.md" class="sidebar-item" aria-label="理解node router路由中间件的原理"><!--[--><!--]--> 理解node router路由中间件的原理 <!--[--><!--]--></a><!----></li><li><a href="/blog/server/node/stream.md" class="sidebar-item" aria-label="理解node stream流"><!--[--><!--]--> 理解node stream流 <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><a href="/blog/server/nginx/" class="sidebar-item" aria-label="nginx"><!--[--><!--]--> nginx <!--[--><!--]--></a><ul style="" class="sidebar-item-children"><!--[--><li><a href="/blog/server/nginx/nginx.md" class="sidebar-item" aria-label="前端nginx知识"><!--[--><!--]--> 前端nginx知识 <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><a href="/blog/server/system/" class="sidebar-item" aria-label="系统"><!--[--><!--]--> 系统 <!--[--><!--]--></a><ul style="" class="sidebar-item-children"><!--[--><li><a href="/blog/server/system/process-thread.md" class="sidebar-item" aria-label="进程和线程"><!--[--><!--]--> 进程和线程 <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><a href="/blog/server/docker/" class="sidebar-item" aria-label="docker"><!--[--><!--]--> docker <!--[--><!--]--></a><ul style="" class="sidebar-item-children"><!--[--><li><a href="/blog/server/docker/shell.md" class="sidebar-item" aria-label="docker shell 自动化脚本"><!--[--><!--]--> docker shell 自动化脚本 <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><a href="/blog/server/k8s/" class="sidebar-item" aria-label="Kubernetes"><!--[--><!--]--> Kubernetes <!--[--><!--]--></a><ul style="" class="sidebar-item-children"><!--[--><li><a href="/blog/server/k8s/index.md" class="sidebar-item" aria-label="Kubernetes 架构"><!--[--><!--]--> Kubernetes 架构 <!--[--><!--]--></a><!----></li><!--]--></ul></li><!--]--></ul></li><li><a href="/blog/network/" class="sidebar-item sidebar-heading" aria-label="网络"><!--[--><!--]--> 网络 <!--[--><!--]--></a><ul style="" class="sidebar-item-children"><!--[--><li><a href="/blog/network/tcp" class="sidebar-item" aria-label="tcp"><!--[--><!--]--> tcp <!--[--><!--]--></a><ul style="" class="sidebar-item-children"><!--[--><li><a href="/blog/network/tcp/connection.md" class="sidebar-item" aria-label="HTTP长连接、短连接和websocket"><!--[--><!--]--> HTTP长连接、短连接和websocket <!--[--><!--]--></a><!----></li><li><a href="/blog/network/tcp/http.md" class="sidebar-item" aria-label="HTTP教程"><!--[--><!--]--> HTTP教程 <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><a href="/blog/network/dns.md" class="sidebar-item" aria-label="DNS解析过程"><!--[--><!--]--> DNS解析过程 <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><a href="/blog/app/" class="sidebar-item sidebar-heading" aria-label="应用端"><!--[--><!--]--> 应用端 <!--[--><!--]--></a><ul style="" class="sidebar-item-children"><!--[--><li><a href="/blog/app/dart" class="sidebar-item" aria-label="dart和runtime(运行时)"><!--[--><!--]--> dart和runtime(运行时) <!--[--><!--]--></a><ul style="" class="sidebar-item-children"><!--[--><li><a href="/blog/app/dart/dart-and-runtime.md" class="sidebar-item" aria-label="dart和runtime(运行时)"><!--[--><!--]--> dart和runtime(运行时) <!--[--><!--]--></a><!----></li><!--]--></ul></li><!--]--></ul></li><!--]--></ul><!--[--><!--]--></aside><!--]--><!--[--><main class="page"><!--[--><!--]--><div class="theme-default-content"><!--[--><!--]--><div><div class="titlelist" data-v-709ce347><!--[--><!--]--></div><h1 id="i18next" tabindex="-1"><a class="header-anchor" href="#i18next" aria-hidden="true">#</a> i18next</h1><p>源代码目录结构图</p><p><img src="/blog/assets/i18next.drawio.25150ee8.svg" alt="i18next架构图"></p><p><a href="https://app.diagrams.net/#G1t4mr-xTsH7L1Cfb-Irjhe6T3AZAexj8a" target="_blank" rel="noopener noreferrer">i18next架构图<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><h2 id="使用demo" tabindex="-1"><a class="header-anchor" href="#使用demo" aria-hidden="true">#</a> 使用demo</h2><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">import</span> i18next <span class="token keyword">from</span> <span class="token string">&#39;i18next&#39;</span><span class="token punctuation">;</span>

i18next<span class="token punctuation">.</span><span class="token function">init</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token literal-property property">lng</span><span class="token operator">:</span> <span class="token string">&#39;en&#39;</span><span class="token punctuation">,</span> <span class="token comment">// if you&#39;re using a language detector, do not define the lng option</span>
  <span class="token literal-property property">debug</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  <span class="token literal-property property">resources</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">en</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token literal-property property">translation</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token string-property property">&quot;key&quot;</span><span class="token operator">:</span> <span class="token string">&quot;hello world&quot;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// initialized and ready to go!</span>
<span class="token comment">// i18next is already initialized, because the translation resources where passed via init function</span>
document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">&#39;output&#39;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>innerHTML <span class="token operator">=</span> i18next<span class="token punctuation">.</span><span class="token function">t</span><span class="token punctuation">(</span><span class="token string">&#39;key&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 显示 hello world</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="调用栈分析" tabindex="-1"><a class="header-anchor" href="#调用栈分析" aria-hidden="true">#</a> 调用栈分析</h3><ol><li>初始化I18next实例对象 <ul><li>1-1 对 init 参数与内置的默认配置进行合并，未设置的参数则进行默认值设置</li><li>1-2 绑定转换器，自带有 Formatter 类。也可以自定义，通过init传入。用于对翻译文本进行格式化的工具类</li><li>1-3 初始化 语言处理工具类 LanguageUtils</li><li>1-4 ResourceStore 实例初始化。用于存储和管理init参数中的resources属性中的不同语言的语言资源</li><li>1-5 初始化 复数形式处理策略工具类 PluralResolver</li><li>1-6 初始化 插值工具类 Interpolator</li><li>1-7 【核心工具】初始化翻译工具类 Translator</li></ul></li><li>i18next.t (是 i18next.translate 方法的别名) <ul><li>2-1 调用 translate 函数</li><li>2-2 调用 resolve 函数，解析翻译键。给定一个翻译键和选项，它会在正确的命名空间（namespace）和语言（language）中查找该键并返回翻译结果</li><li>2-3 对翻译结果进行复数转化</li></ul></li><li>返回最终翻译词条</li></ol><h2 id="简化源码分析" tabindex="-1"><a class="header-anchor" href="#简化源码分析" aria-hidden="true">#</a> 简化源码分析</h2><h3 id="index-js" tabindex="-1"><a class="header-anchor" href="#index-js" aria-hidden="true">#</a> index.js</h3><p>i18next 的入口文件，主要是对外暴露 i18next 对象及对象内的常用方法</p><h3 id="i18n-i18next-js" tabindex="-1"><a class="header-anchor" href="#i18n-i18next-js" aria-hidden="true">#</a> I18n (i18next.js)</h3><h4 id="构造函数" tabindex="-1"><a class="header-anchor" href="#构造函数" aria-hidden="true">#</a> 构造函数</h4><p>I18n的构造函数做了一系列的准备工作</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">import</span> baseLogger <span class="token keyword">from</span> <span class="token string">&#39;./logger.js&#39;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> EventEmitter <span class="token keyword">from</span> <span class="token string">&#39;./EventEmitter.js&#39;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> ResourceStore <span class="token keyword">from</span> <span class="token string">&#39;./ResourceStore.js&#39;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> Translator <span class="token keyword">from</span> <span class="token string">&#39;./Translator.js&#39;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> LanguageUtils <span class="token keyword">from</span> <span class="token string">&#39;./LanguageUtils.js&#39;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> PluralResolver <span class="token keyword">from</span> <span class="token string">&#39;./PluralResolver.js&#39;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> Interpolator <span class="token keyword">from</span> <span class="token string">&#39;./Interpolator.js&#39;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> Formatter <span class="token keyword">from</span> <span class="token string">&#39;./Formatter.js&#39;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> BackendConnector <span class="token keyword">from</span> <span class="token string">&#39;./BackendConnector.js&#39;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> <span class="token keyword">get</span> <span class="token keyword">as</span> getDefaults<span class="token punctuation">,</span> transformOptions <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;./defaults.js&#39;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> postProcessor <span class="token keyword">from</span> <span class="token string">&#39;./postProcessor.js&#39;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> defer <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;./utils.js&#39;</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">I18n</span> <span class="token keyword">extends</span> <span class="token class-name">EventEmitter</span> <span class="token punctuation">{</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter">options <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> callback</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">super</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">this</span><span class="token punctuation">.</span>options <span class="token operator">=</span> <span class="token function">transformOptions</span><span class="token punctuation">(</span>options<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// 存储各种服务(工具类)的对象,方便在后续的操作中调用这些服务(工具类的方法或属性)</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>services <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>logger <span class="token operator">=</span> baseLogger<span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>modules <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token literal-property property">external</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>

    <span class="token doc-comment comment">/** ... */</span>

    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">init</span><span class="token punctuation">(</span>options<span class="token punctuation">,</span> callback<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token comment">//  初始化工作</span>
  <span class="token function">init</span><span class="token punctuation">(</span><span class="token parameter">options <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> callback</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> options <span class="token operator">===</span> <span class="token string">&#39;function&#39;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      callback <span class="token operator">=</span> options<span class="token punctuation">;</span>
      options <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// 缓存命名空间的默认值</span>
    options<span class="token punctuation">.</span>defaultNS <span class="token operator">=</span> <span class="token operator">...</span><span class="token punctuation">;</span>

    <span class="token comment">// 缓存默认配置</span>
    <span class="token keyword">const</span> defOpts <span class="token operator">=</span> <span class="token function">getDefaults</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// 默认配置、用户配置、翻译所需要的配置合并</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>options <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token operator">...</span>defOpts<span class="token punctuation">,</span> <span class="token operator">...</span><span class="token keyword">this</span><span class="token punctuation">.</span>options<span class="token punctuation">,</span> <span class="token operator">...</span><span class="token function">transformOptions</span><span class="token punctuation">(</span>options<span class="token punctuation">)</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
    
    <span class="token doc-comment comment">/** ... */</span>

    <span class="token comment">// 缓存 key 分隔符 默认值</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>options<span class="token punctuation">.</span>userDefinedKeySeparator <span class="token operator">=</span> <span class="token operator">...</span><span class="token punctuation">;</span>
    <span class="token comment">//  缓存 命名空间分隔符</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>options<span class="token punctuation">.</span>userDefinedNsSeparator <span class="token operator">=</span> <span class="token operator">...</span><span class="token punctuation">;</span>

    <span class="token doc-comment comment">/** ... */</span>

    <span class="token comment">// init services</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token keyword">this</span><span class="token punctuation">.</span>options<span class="token punctuation">.</span>isClone<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// 初始化日志工具</span>
      baseLogger<span class="token punctuation">.</span><span class="token function">init</span><span class="token punctuation">(</span><span class="token operator">...</span><span class="token punctuation">)</span>

      <span class="token comment">// 指定要使用的格式转换器类</span>
      <span class="token keyword">let</span> formatter <span class="token operator">=</span> Formatter<span class="token punctuation">;</span><span class="token punctuation">;</span>

      <span class="token comment">// 语言处理工具(获取语言名称，格式化语言编码(code)、处理语言名称不完全匹配时的默认策略和语言的解析顺序)</span>
      <span class="token keyword">const</span> lu <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">LanguageUtils</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>options<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token comment">// 用于存储和管理翻译资源的类(增删改查，数据存储在内存中)</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>store <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ResourceStore</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>options<span class="token punctuation">.</span>resources<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>options<span class="token punctuation">)</span><span class="token punctuation">;</span>

      <span class="token comment">// 把公共工具都存在 services中方便取</span>
      <span class="token keyword">const</span> s <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>services<span class="token punctuation">;</span>
      s<span class="token punctuation">.</span>logger <span class="token operator">=</span> baseLogger<span class="token punctuation">;</span>
      s<span class="token punctuation">.</span>resourceStore <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>store<span class="token punctuation">;</span>
      s<span class="token punctuation">.</span>languageUtils <span class="token operator">=</span> lu<span class="token punctuation">;</span>
      <span class="token comment">// 处理语言的复数形式</span>
      s<span class="token punctuation">.</span>pluralResolver <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">PluralResolver</span><span class="token punctuation">(</span><span class="token operator">...</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      
      <span class="token doc-comment comment">/** ... */</span>

      <span class="token comment">// 用来解析翻译资源中的插值表达式的工具类</span>
      s<span class="token punctuation">.</span>interpolator <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Interpolator</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>options<span class="token punctuation">)</span><span class="token punctuation">;</span>
      s<span class="token punctuation">.</span>utils <span class="token operator">=</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">hasLoadedNamespace</span><span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">hasLoadedNamespace</span><span class="token punctuation">.</span><span class="token function">bind</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span>

      <span class="token comment">// 用于连接 i18next 的后端和存储，将从远端加载的词条存储在内存中</span>
      s<span class="token punctuation">.</span>backendConnector <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">BackendConnector</span><span class="token punctuation">(</span><span class="token operator">...</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token comment">// pipe events from backendConnector</span>
      s<span class="token punctuation">.</span>backendConnector<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">&#39;*&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">event<span class="token punctuation">,</span> <span class="token operator">...</span>args</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">emit</span><span class="token punctuation">(</span>event<span class="token punctuation">,</span> <span class="token operator">...</span>args<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

      <span class="token comment">// 用于进行国际化翻译 的核心工具</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>translator <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Translator</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>services<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>options<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token comment">// pipe events from translator</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>translator<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">&#39;*&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">event<span class="token punctuation">,</span> <span class="token operator">...</span>args</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">emit</span><span class="token punctuation">(</span>event<span class="token punctuation">,</span> <span class="token operator">...</span>args<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token doc-comment comment">/** ... */</span>

    <span class="token keyword">const</span> deferred <span class="token operator">=</span> <span class="token function">defer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token doc-comment comment">/** ... */</span>

    <span class="token keyword">return</span> deferred<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token comment">//   加载语言资源</span>
  <span class="token function">loadResources</span><span class="token punctuation">(</span><span class="token parameter">language<span class="token punctuation">,</span> callback <span class="token operator">=</span> noop</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
  <span class="token comment">// 重新加载语言资源  </span>
  <span class="token function">reloadResources</span><span class="token punctuation">(</span><span class="token parameter">lngs<span class="token punctuation">,</span> ns<span class="token punctuation">,</span> callback</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
  <span class="token doc-comment comment">/**
   * // 用于将插件模块添加到 i18next 实例中。通过这个方法，您可以扩展 i18next 的功能，添加自定义的功能或处理特定的任务。
   * // demo
   * import i18next from &#39;i18next&#39;;
   * import yourPlugin from &#39;your-plugin&#39;;
   * 
   * i18next.use(yourPlugin).init(<span class="token punctuation">{</span>
   * // 初始化选项
   * <span class="token punctuation">}</span>);
   */</span>
  <span class="token function">use</span><span class="token punctuation">(</span><span class="token parameter">module</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

  <span class="token comment">// 在语言切换时更新已解析的语言</span>
  <span class="token function">setResolvedLanguage</span><span class="token punctuation">(</span><span class="token parameter">l</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
  
  <span class="token comment">// 切换当前的语言</span>
  <span class="token function">changeLanguage</span><span class="token punctuation">(</span><span class="token parameter">lng<span class="token punctuation">,</span> callback</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
  <span class="token doc-comment comment">/**
   * // 获取一个固定的翻译函数
   * // demo
   * const fixedT = i18next.getFixedT(&#39;en&#39;, &#39;common&#39;, &#39;prefix&#39;);
   * // 使用固定的翻译函数进行翻译
   * const translatedText = fixedT(&#39;hello&#39;); // 使用键 &#39;prefix.hello&#39; 进行翻译
   * console.log(translatedText); // 输出翻译后的文本
   */</span>
  <span class="token function">getFixedT</span><span class="token punctuation">(</span><span class="token parameter">lng<span class="token punctuation">,</span> ns<span class="token punctuation">,</span> keyPrefix</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

  <span class="token comment">// translate 方法的别名</span>
  <span class="token function">t</span><span class="token punctuation">(</span><span class="token parameter"><span class="token operator">...</span>args</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>translator <span class="token operator">&amp;&amp;</span> <span class="token keyword">this</span><span class="token punctuation">.</span>translator<span class="token punctuation">.</span><span class="token function">translate</span><span class="token punctuation">(</span><span class="token operator">...</span>args<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token comment">// translator.exists 方法的别名</span>
  <span class="token function">exists</span><span class="token punctuation">(</span><span class="token parameter"><span class="token operator">...</span>args</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>translator <span class="token operator">&amp;&amp;</span> <span class="token keyword">this</span><span class="token punctuation">.</span>translator<span class="token punctuation">.</span><span class="token function">exists</span><span class="token punctuation">(</span><span class="token operator">...</span>args<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token function">setDefaultNamespace</span><span class="token punctuation">(</span><span class="token parameter">ns</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>options<span class="token punctuation">.</span>defaultNS <span class="token operator">=</span> ns<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token comment">// 检查给定的命名空间是否已被加载或预加载</span>
  <span class="token function">hasLoadedNamespace</span><span class="token punctuation">(</span><span class="token parameter">ns<span class="token punctuation">,</span> options <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
  <span class="token comment">// 异步加载指定的命名空间</span>
  <span class="token function">loadNamespaces</span><span class="token punctuation">(</span><span class="token parameter">ns<span class="token punctuation">,</span> callback</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
  <span class="token comment">// 异步加载语言资源</span>
  <span class="token function">loadLanguages</span><span class="token punctuation">(</span><span class="token parameter">lngs<span class="token punctuation">,</span> callback</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
  <span class="token comment">// 根据传入的语言代码 lng，i18next.dir(lng) 方法会返回一个表示文本方向的字符串，可以是 &quot;ltr&quot;（从左到右）或 &quot;rtl&quot;（从右到左）。</span>
  <span class="token function">dir</span><span class="token punctuation">(</span><span class="token parameter">lng</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
  <span class="token comment">// 创建I18n实例</span>
  <span class="token keyword">static</span> <span class="token function-variable function">createInstance</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">options <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> callback</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">new</span> <span class="token class-name">I18n</span><span class="token punctuation">(</span>options<span class="token punctuation">,</span> callback<span class="token punctuation">)</span>
  <span class="token comment">// 拷贝I18n实例 </span>
  <span class="token function">cloneInstance</span><span class="token punctuation">(</span><span class="token parameter">options <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> callback <span class="token operator">=</span> noop</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
  <span class="token comment">// I18n实例要序列化的数据</span>
  <span class="token function">toJSON</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> instance <span class="token operator">=</span> I18n<span class="token punctuation">.</span><span class="token function">createInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
instance<span class="token punctuation">.</span>createInstance <span class="token operator">=</span> I18n<span class="token punctuation">.</span>createInstance<span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> instance<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h5 id="services" tabindex="-1"><a class="header-anchor" href="#services" aria-hidden="true">#</a> services</h5><p>存储各种服务(工具类)的对象,方便在后续的操作中调用这些服务(工具类的方法或属性)</p><h5 id="logger" tabindex="-1"><a class="header-anchor" href="#logger" aria-hidden="true">#</a> logger</h5><p>logger，日志插件，必须符合Logger的定义。在程序中打印日志</p><h5 id="modules" tabindex="-1"><a class="header-anchor" href="#modules" aria-hidden="true">#</a> modules</h5><p>用于存储和管理 i18next 扩展模块。</p><h3 id="translator-js" tabindex="-1"><a class="header-anchor" href="#translator-js" aria-hidden="true">#</a> Translator.js</h3><p>i18next 的翻译器，负责将语言资源翻译成指定语言的文本，并使用指定的选项进行格式化和插值。</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">import</span> baseLogger <span class="token keyword">from</span> <span class="token string">&#39;./logger.js&#39;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> EventEmitter <span class="token keyword">from</span> <span class="token string">&#39;./EventEmitter.js&#39;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> postProcessor <span class="token keyword">from</span> <span class="token string">&#39;./postProcessor.js&#39;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token operator">*</span> <span class="token keyword">as</span> utils <span class="token keyword">from</span> <span class="token string">&#39;./utils.js&#39;</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">Translator</span> <span class="token keyword">extends</span> <span class="token class-name">EventEmitter</span> <span class="token punctuation">{</span>
    <span class="token comment">// 更改当前语言。</span>
    <span class="token function">changeLanguage</span><span class="token punctuation">(</span><span class="token parameter">lng</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">}</span>
    <span class="token doc-comment comment">/**
     * 用于检查指定的语言资源是否存在。
     * <span class="token keyword">@param</span> <span class="token class-name"><span class="token punctuation">{</span><span class="token operator">*</span><span class="token punctuation">}</span></span> <span class="token parameter">key</span> - 要检查的语言资源键
     * <span class="token keyword">@returns</span> boolean
     */</span>
    <span class="token function">exists</span><span class="token punctuation">(</span><span class="token parameter">key<span class="token punctuation">,</span> options <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token literal-property property">interpolation</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span> <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
    <span class="token comment">// 用于从指定的语言资源键（key）中提取命名空间（namespace）和语言资源的名称（keyWithoutNs）</span>
    <span class="token function">extractFromKey</span><span class="token punctuation">(</span><span class="token parameter">key<span class="token punctuation">,</span> options</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
    <span class="token comment">// 核心函数，用于将指定的语言资源翻译成当前想要的语言，并使用指定的选项进行格式化和插值。外部常调用的别名是 i18next.t()</span>
    <span class="token function">translate</span><span class="token punctuation">(</span><span class="token parameter">keys<span class="token punctuation">,</span> options<span class="token punctuation">,</span> lastKey</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
    <span class="token doc-comment comment">/**
     * 该函数的作用是在运行时扩展语言资源。在进行扩展时，该函数会将 key 参数解析为命名空间和语言资源的名称，然后将指定的语言资源添加到 res 对象中。
     * <span class="token keyword">@param</span> <span class="token class-name"><span class="token punctuation">{</span><span class="token operator">*</span><span class="token punctuation">}</span></span> <span class="token parameter">res</span> - 要扩展的语言资源对象
     * <span class="token keyword">@param</span> <span class="token class-name"><span class="token punctuation">{</span><span class="token operator">*</span><span class="token punctuation">}</span></span> <span class="token parameter">key</span> - 要扩展的语言资源键
     * <span class="token keyword">@param</span> <span class="token class-name"><span class="token punctuation">{</span><span class="token operator">*</span><span class="token punctuation">}</span></span> <span class="token parameter">options</span> - 要添加的语言资源
     * <span class="token keyword">@param</span> <span class="token class-name"><span class="token punctuation">{</span><span class="token operator">*</span><span class="token punctuation">}</span></span> <span class="token parameter">resolved</span> - 一个可选对象，包含运行时解析的键和值
     * <span class="token keyword">@param</span> <span class="token class-name"><span class="token punctuation">{</span><span class="token operator">*</span><span class="token punctuation">}</span></span> <span class="token parameter">lastKey</span> - 用于指定上一个翻译键的参数，可以用于实现嵌套翻译
     * <span class="token keyword">@returns</span> 
     */</span>
    <span class="token function">extendTranslation</span><span class="token punctuation">(</span><span class="token parameter">res<span class="token punctuation">,</span> key<span class="token punctuation">,</span> options<span class="token punctuation">,</span> resolved<span class="token punctuation">,</span> lastKey</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
    <span class="token doc-comment comment">/**
     * 用于解析翻译键（translation key）。给定一个翻译键和选项，它会在正确的命名空间（namespace）和语言（language）中查找该键并返回翻译结果
     * <span class="token keyword">@param</span> <span class="token class-name"><span class="token punctuation">{</span><span class="token operator">*</span><span class="token punctuation">}</span></span> <span class="token parameter">keys</span> - 要解析的翻译键（可以是字符串或字符串数组）
     * <span class="token keyword">@param</span> <span class="token class-name"><span class="token punctuation">{</span><span class="token operator">*</span><span class="token punctuation">}</span></span> <span class="token parameter">options</span> 一个选项对象，包含以下属性：
     *          -  count：用于复数形式的计数（可选）。
     *          -  context：用于上下文翻译的上下文字符串（可选）。
     *          -  lngs：要使用的语言列表（可选）。
     *          -  ordinal：是否使用序数复数形式（可选）。
     * <span class="token keyword">@returns</span> 返回一个对象，包含以下属性:
     *          - res：解析出的资源。
     *          -  usedKey：用于解析的最终翻译键。
     *          -  exactUsedKey：用于解析的最终翻译键（包括上下文和复数形式）。
     *          -  usedLng：用于解析的语言。
     *          -  usedNS：用于解析的命名空间。
     */</span>
    <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token parameter">keys<span class="token punctuation">,</span> options <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
    <span class="token comment">// 检查res的值是否有效，用意是检查是否已找到有效的翻译资源</span>
    <span class="token function">isValidLookup</span><span class="token punctuation">(</span><span class="token parameter">res</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
    <span class="token comment">// 用于获取指定语言、命名空间和翻译键对应的翻译资源。</span>
    <span class="token function">getResource</span><span class="token punctuation">(</span><span class="token parameter">code<span class="token punctuation">,</span> ns<span class="token punctuation">,</span> key<span class="token punctuation">,</span> options <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
    <span class="token comment">// 用于检查选项对象中是否设置了defaultValue属性</span>
    <span class="token keyword">static</span> <span class="token function">hasDefaultValue</span><span class="token punctuation">(</span><span class="token parameter">options</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="interpolator-js" tabindex="-1"><a class="header-anchor" href="#interpolator-js" aria-hidden="true">#</a> Interpolator.js</h3><p>用于对语言资源中的变量进行替换。主要的 API 包括 interpolate() 和 nest()。</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">import</span> <span class="token operator">*</span> <span class="token keyword">as</span> utils <span class="token keyword">from</span> <span class="token string">&#39;./utils.js&#39;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> baseLogger <span class="token keyword">from</span> <span class="token string">&#39;./logger.js&#39;</span><span class="token punctuation">;</span>

<span class="token doc-comment comment">/**
 * Finds a value in data object using a key and returns it.
 * If the value is not found, it uses defaultData to find the value.
 * If ignoreJSONStructure is true, it ignores the JSON structure of the data object.
 */</span>
<span class="token keyword">function</span> <span class="token function">deepFindWithDefaults</span><span class="token punctuation">(</span>data<span class="token punctuation">,</span> defaultData<span class="token punctuation">,</span> key<span class="token punctuation">,</span> keySeparator <span class="token operator">=</span> <span class="token string">&#39;.&#39;</span><span class="token punctuation">,</span> ignoreJSONStructure <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

<span class="token doc-comment comment">/**
 * <span class="token keyword">@class</span> <span class="token class-name">Interpolator</span> 用来解析翻译资源中的插值表达式的工具类
 * 在 i18next 中，插值表达式用花括号 <span class="token punctuation">{</span><span class="token punctuation">}</span> 包裹变量和占位符，例如 <span class="token punctuation">{</span>name<span class="token punctuation">}</span> 或 <span class="token punctuation">{</span>count, plural, one<span class="token punctuation">{</span># dog<span class="token punctuation">}</span> other<span class="token punctuation">{</span># dogs<span class="token punctuation">}</span><span class="token punctuation">}</span>。Interpolator 类会将这些插值表达式解析为实际的值，并将其插入到翻译资源中生成最终的翻译结果。
 */</span>
<span class="token keyword">class</span> <span class="token class-name">Interpolator</span> <span class="token punctuation">{</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter">options <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

  <span class="token comment">/* eslint no-param-reassign: 0 */</span>
  <span class="token doc-comment comment">/**
   * 初始化插值器。
   * <span class="token keyword">@param</span> <span class="token class-name"><span class="token punctuation">{</span>Object<span class="token punctuation">}</span></span> <span class="token parameter">options</span> - 选项对象。
   * <span class="token keyword">@param</span> <span class="token class-name"><span class="token punctuation">{</span>string<span class="token punctuation">}</span></span> <span class="token parameter">options<span class="token punctuation">.</span>interpolationPrefix</span> - 插值器前缀，默认为&#39;<span class="token punctuation">{</span><span class="token punctuation">{</span>&#39;。
   * <span class="token keyword">@param</span> <span class="token class-name"><span class="token punctuation">{</span>string<span class="token punctuation">}</span></span> <span class="token parameter">options<span class="token punctuation">.</span>interpolationSuffix</span> - 插值器后缀，默认为&#39;<span class="token punctuation">}</span><span class="token punctuation">}</span>&#39;。
   * <span class="token keyword">@param</span> <span class="token class-name"><span class="token punctuation">{</span>Object<span class="token punctuation">}</span></span> <span class="token parameter">options<span class="token punctuation">.</span>interpolation</span> - 插值器设置。
   * <span class="token keyword">@param</span> <span class="token class-name"><span class="token punctuation">{</span>string<span class="token punctuation">}</span></span> <span class="token parameter">options<span class="token punctuation">.</span>interpolation<span class="token punctuation">.</span>escapeValue</span> - 转义函数，默认为false。
   * <span class="token keyword">@param</span> <span class="token class-name"><span class="token punctuation">{</span>string<span class="token punctuation">}</span></span> <span class="token parameter">options<span class="token punctuation">.</span>interpolation<span class="token punctuation">.</span>nestSeparator</span> - 嵌套分隔符，默认为&#39;.&#39;。
   */</span>
  <span class="token function">init</span><span class="token punctuation">(</span><span class="token parameter">options <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
  <span class="token comment">// 重置选项</span>
  <span class="token function">reset</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>options<span class="token punctuation">)</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">init</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>options<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token comment">// 重置匹配规则</span>
  <span class="token function">resetRegExp</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

  <span class="token doc-comment comment">/**
   * 对给定的字符串进行插值操作
   * <span class="token keyword">@param</span> <span class="token class-name"><span class="token punctuation">{</span><span class="token operator">*</span><span class="token punctuation">}</span></span> <span class="token parameter">str</span> 字符串模版
   * <span class="token keyword">@param</span> <span class="token class-name"><span class="token punctuation">{</span><span class="token operator">*</span><span class="token punctuation">}</span></span> <span class="token parameter">data</span> 要插入的对象值
   * <span class="token keyword">@param</span> <span class="token class-name"><span class="token punctuation">{</span><span class="token operator">*</span><span class="token punctuation">}</span></span> <span class="token parameter">lng</span> 语言
   * <span class="token keyword">@param</span> <span class="token class-name"><span class="token punctuation">{</span><span class="token operator">*</span><span class="token punctuation">}</span></span> <span class="token parameter">options</span> 
   * <span class="token keyword">@returns</span> 
   */</span>
  <span class="token function">interpolate</span><span class="token punctuation">(</span><span class="token parameter">str<span class="token punctuation">,</span> data<span class="token punctuation">,</span> lng<span class="token punctuation">,</span> options</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

  <span class="token doc-comment comment">/**
   * 将字符串中的嵌套值替换为给定对象的值
   * <span class="token keyword">@param</span> <span class="token class-name"><span class="token punctuation">{</span>string<span class="token punctuation">}</span></span> <span class="token parameter">str</span> - 要替换的字符串模版
   * <span class="token keyword">@param</span> <span class="token class-name"><span class="token punctuation">{</span>Function<span class="token punctuation">}</span></span> <span class="token parameter">fc</span> - 用于获取嵌套属性的值的函数。该函数主要接受一个参数，即嵌套属性的名称，返回该属性的值(另外一个参数只是options的一部分)
   */</span>
  <span class="token function">nest</span><span class="token punctuation">(</span><span class="token parameter">str<span class="token punctuation">,</span> fc<span class="token punctuation">,</span> options <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> Interpolator<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="pluralresolver-js" tabindex="-1"><a class="header-anchor" href="#pluralresolver-js" aria-hidden="true">#</a> PluralResolver.js</h3><p>处理复数形式的工具类，它提供了一个方法 getSuffix，用来根据语言标签和数量计算复数形式的后缀。</p><p>内置了很多语言的处理规则， 主要的 API 包括 getSuffix() 和 get()。</p><p>use demo</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// 初始化 i18next 库</span>
i18next<span class="token punctuation">.</span><span class="token function">init</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token literal-property property">lng</span><span class="token operator">:</span> <span class="token string">&#39;en&#39;</span><span class="token punctuation">,</span>
  <span class="token literal-property property">resources</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">en</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token literal-property property">translation</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">dogs</span><span class="token operator">:</span> <span class="token string">&#39;{{count}} dog&#39;</span><span class="token punctuation">,</span>
        <span class="token literal-property property">dogs_plural</span><span class="token operator">:</span> <span class="token string">&#39;{{count}} dogs&#39;</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token comment">// 配置 PluralResolver 类</span>
  <span class="token literal-property property">pluralResolver</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token comment">// 英语的复数形式后缀为 &quot;_plural&quot;</span>
    <span class="token literal-property property">suffix</span><span class="token operator">:</span> <span class="token string">&#39;_plural&#39;</span><span class="token punctuation">,</span>
    <span class="token comment">// 英语的复数形式规则为 &quot;1&quot; 表示单数，其他情况为复数</span>
    <span class="token literal-property property">rules</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token function-variable function">plural</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">n</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> n <span class="token operator">!==</span> <span class="token number">1</span><span class="token punctuation">;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 定义一个函数，用于获取翻译结果</span>
<span class="token keyword">function</span> <span class="token function">t</span><span class="token punctuation">(</span><span class="token parameter">key<span class="token punctuation">,</span> count<span class="token punctuation">,</span> options</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// 调用 PluralResolver 类的 getSuffix 方法，获取复数形式的后缀</span>
  <span class="token keyword">var</span> suffix <span class="token operator">=</span> i18next<span class="token punctuation">.</span>services<span class="token punctuation">.</span>pluralResolver<span class="token punctuation">.</span><span class="token function">getSuffix</span><span class="token punctuation">(</span><span class="token string">&#39;en&#39;</span><span class="token punctuation">,</span> count<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// 使用 i18next 库的 t 函数获取翻译结果</span>
  <span class="token keyword">return</span> i18next<span class="token punctuation">.</span><span class="token function">t</span><span class="token punctuation">(</span>key <span class="token operator">+</span> suffix<span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token literal-property property">count</span><span class="token operator">:</span> count <span class="token punctuation">}</span><span class="token punctuation">,</span> options<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// 测试 t 函数</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">t</span><span class="token punctuation">(</span><span class="token string">&#39;dogs&#39;</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 输出 &quot;0 dogs&quot;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">t</span><span class="token punctuation">(</span><span class="token string">&#39;dogs&#39;</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 输出 &quot;1 dog&quot;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">t</span><span class="token punctuation">(</span><span class="token string">&#39;dogs&#39;</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 输出 &quot;2 dogs&quot;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>在 t 函数中，我们调用 getSuffix 方法来获取复数形式的后缀，然后将其与翻译资源的键值拼接在一起，使用 i18next 库的 t 函数来获取翻译结果。最后，我们测试了 t 函数，分别传入了 0、1 和 2 三个参数。根据英语的复数形式规则，当 count 为 1 时，应该使用单数形式，否则应该使用复数形式。</p><h3 id="languageutils-js" tabindex="-1"><a class="header-anchor" href="#languageutils-js" aria-hidden="true">#</a> LanguageUtils.js</h3><p>获取语言，格式化语言编码(code)、处理语言不完全匹配时的默认策略和解析顺序</p><blockquote><p>语言代码是一种用于表示语言和地区的标识符。它通常由两个或三个部分组成，每个部分之间用连字符分隔。例如，&quot;en&quot; 表示英语，&quot;en-US&quot; 表示美式英语，&quot;zh-Hans-CN&quot; 表示简体中文（中国大陆）。</p><p>语言代码的命名规则由 IETF 标准化组织定义，它定义了一套语言标签规范，用于标识语言、方言和地区。语言标签由一个或多个子标记（subtags）组成，每个子标记表示一个特定的语言、方言或地区。子标记之间用连字符 &quot;-&quot; 分隔。</p><p>例如，&quot;en-US&quot; 表示英语（en）和美国（US）地区的结合，而 &quot;zh-Hans-CN&quot; 表示简体中文（zh）和中国大陆（CN）地区的结合，其中 &quot;Hans&quot; 表示简体中文的一种书写形式。</p><p>在语言代码的处理中，需要考虑到多种情况，例如大小写、特殊代码（如 &quot;hans&quot;、&quot;hant&quot;、&quot;latn&quot;、&quot;cyrl&quot;、&quot;cans&quot;、&quot;mong&quot;、&quot;arab&quot;）和三位代码（如 &quot;zh-Hans-CN&quot;）等。因此，对于语言代码的处理需要使用一些专门的工具和方法，以便能够对不同的情况进行适当的处理和转换。</p></blockquote><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">class</span> <span class="token class-name">LanguageUtil</span> <span class="token punctuation">{</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter">options</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

  <span class="token doc-comment comment">/**
   * 从指定的语言代码中获取脚本部分，例如 &quot;zh-Hans-CN&quot; 中的 &quot;Hans&quot;
   * i18next是完全遵循了BCP47的标准来格式化语言标记，也就是code，语言编码
   */</span>
  <span class="token function">getScriptPartFromCode</span><span class="token punctuation">(</span><span class="token parameter">code</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

  <span class="token doc-comment comment">/**
   * 从指定的语言代码中获取语言部分，例如 &quot;zh-Hans-CN&quot; 中的 &quot;zh&quot;。
   */</span>
  <span class="token function">getLanguagePartFromCode</span><span class="token punctuation">(</span><span class="token parameter">code</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

  <span class="token doc-comment comment">/**
   * 格式化指定的语言代码，例如 &quot;zh-Hans-CN&quot; 字符串传进来时大小写不规范转为固定规范
   * 如果传入的参数不是字符串类型或者不包含连字符（-），则直接返回原始参数值。
   * 如果传入的参数包含连字符（-），则按照以下规则进行格式化：
   *  如果使用了 lowerCaseLng 选项，则将语言代码和国家代码部分都转换为小写。
   *  如果语言代码只有两个部分，则将第一个部分转换为小写，第二个部分转换为大写，并将一些特殊的代码（如 &quot;hans&quot;、&quot;hant&quot;、&quot;latn&quot;、&quot;cyrl&quot;、&quot;cans&quot;、&quot;mong&quot;、&quot;arab&quot;）转换为首字母大写的形式。
   *  如果语言代码有三个部分，则将第一个部分转换为小写，第二个和第三个部分分别转换为大写，并将一些特殊的代码转换为首字母大写的形式。
   * 最后，将处理后的语言代码的各个部分用连字符连接起来，并返回结果。
   * 需要注意的是，formatLanguageCode 方法并不会对语言代码的合法性进行检查，因此在使用该方法时需要确保传入的参数是符合语言代码规范的。
   */</span>
  <span class="token function">formatLanguageCode</span><span class="token punctuation">(</span><span class="token parameter">code</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

  <span class="token doc-comment comment">/**
   * isSupportedCode 函数用于检查指定的语言代码是否被支持
   * 该函数接受一个语言代码字符串作为参数，返回一个布尔值，表示指定的语言代码是否被支持
   * 如果 load 选项设置为 &quot;languageOnly&quot; 或者 nonExplicitSupportedLngs 选项为真，则将传入的语言代码转换成只包含语言部分的形式。
   * 如果 supportedLngs 选项没有设置或者为空数组，则认为支持所有语言代码，直接返回 true。
   * 否则，检查传入的语言代码是否在 supportedLngs 列表中出现，如果出现则返回 true，否则返回 false。
   */</span>
  <span class="token function">isSupportedCode</span><span class="token punctuation">(</span><span class="token parameter">code</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

  <span class="token doc-comment comment">/**
   * 函数用于从给定的语言代码列表中获取最佳匹配的语言代码。该函数接受一个语言代码列表作为参数，返回一个语言代码字符串，表示最佳匹配的语言代码。具体实现如下：
   * 如果传入的语言代码列表为空，则直接返回 null。
   * 遍历传入的语言代码列表，对于每个语言代码，首先将其格式化为规范形式（使用 formatLanguageCode 方法）。然后检查该语言代码是否被支持（使用 isSupportedCode 方法）。如果该语言代码被支持，则将其设为找到的最佳匹配，并终止循环。
   * 如果上述步骤没有找到任何匹配的语言代码，并且 supportedLngs 选项已设置，则尝试查找类似的语言代码。具体来说，对于每个语言代码，首先获取其语言部分（使用 getLanguagePartFromCode 方法），然后检查该语言部分是否被支持。如果被支持，则将其设为找到的最佳匹配，并终止循环。否则，使用 supportedLngs 列表中的语言代码进行匹配。具体来说，遍历 supportedLngs 列表，对于每个语言代码，如果它和语言部分相同，则将其设为找到的最佳匹配，并终止循环。
   * 如果上述步骤没有找到任何匹配的语言代码，则使用 fallbackLng 选项中指定的语言代码作为最佳匹配。
   * 最后，返回找到的最佳匹配语言代码。
   * 需要注意的是，该函数实现了一个简单的算法，用于从给定的语言代码列表中获取最佳匹配的语言代码。它首先尝试找到一个被支持的语言代码，如果找不到，则尝试找到一个类似的语言代码，并使用该语言代码作为最佳匹配。如果还是找不到，则使用 fallbackLng 选项中指定的语言代码作为最佳匹配。但是，该算法并不一定能够找到最合适的语言代码，因此在实际使用中，可能需要根据具体需求进行调整或者改进。
   * 
   * // use demo
   * 
   * import i18next from &#39;i18next&#39;;

   * i18next.init(<span class="token punctuation">{</span>
   *  lng: &#39;en&#39;,
   *  supportedLngs: [&#39;en&#39;, &#39;fr&#39;, &#39;es&#39;, &#39;zh&#39;],
   *  fallbackLng: &#39;en&#39;,
   *<span class="token punctuation">}</span>);
   *
   * const codes = [&#39;zh-CN&#39;, &#39;fr-CA&#39;, &#39;ja-JP&#39;];
   * const bestMatch = i18next.getBestMatchFromCodes(codes);
   * console.log(bestMatch); // &quot;fr&quot;
   * // 设置了支持的语言列表和默认语言等选项。然后定义了一个语言代码列表 codes，包含三个语言代码：zh-CN、fr-CA 和 ja-JP。最后调用 getBestMatchFromCodes 函数，传入语言代码列表 codes，获取最佳匹配的语言代码。在这个例子中，最佳匹配的语言代码是 fr，因为它是在 supportedLngs 列表中最先出现的被支持的语言代码。
   */</span>
  <span class="token function">getBestMatchFromCodes</span><span class="token punctuation">(</span><span class="token parameter">codes</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

  <span class="token doc-comment comment">/**
   * getFallbackCodes 函数用于获取给定语言代码的后备语言代码列表。该函数接受两个参数：fallbacks 和 code，其中 fallbacks 表示后备语言代码的定义，可以是一个字符串、一个函数或者一个包含后备语言代码定义的对象；code 表示要获取后备语言代码的语言代码。具体实现如下：
   * 
   * 如果 fallbacks 为空或者未定义，则返回空数组。
   * 
   * 如果 fallbacks 是一个函数，则调用该函数，并将 code 作为参数传递给它，获取后备语言代码列表。
   * 
   * 如果 fallbacks 是一个字符串，则将其转换为包含该字符串的数组。
   * 
   * 如果 fallbacks 是一个数组，则直接返回该数组。
   * 
   * 如果 fallbacks 是一个对象，则尝试根据 code 获取后备语言代码。具体来说，依次尝试使用以下四个方法获取后备语言代码：
   * 
   * 使用 code 作为键获取后备语言代码。
   * 使用 code 的脚本部分作为键获取后备语言代码。
   * 使用 code 的语言部分作为键获取后备语言代码。
   * 使用 default 作为键获取后备语言代码。
   * 如果上述方法都没有找到后备语言代码，则返回空数组。
   * 
   * 最后，返回找到的后备语言代码列表。
   * 
   * 需要注意的是，getFallbackCodes 函数并不会自动获取任何后备语言代码，而是根据传入的 fallbacks 和 code 参数，返回相应的后备语言代码列表。在实际使用中，需要根据具体需求定义后备语言代码，并传递给 fallbacks 参数。
   * 
   * //use demo
   * 
   * import i18next from &#39;i18next&#39;;
   * 
   * i18next.init(<span class="token punctuation">{</span>
   *    lng: &#39;en&#39;,
   *    fallbackLng: &#39;en&#39;,
   *    fallbacks: <span class="token punctuation">{</span>
   *      en: [&#39;en-US&#39;, &#39;en-GB&#39;],
   *      fr: [&#39;fr-FR&#39;],
   *    <span class="token punctuation">}</span>,
   *  <span class="token punctuation">}</span>);
   * 
   *  const code = &#39;en-CA&#39;;
   *  const fallbackCodes = i18next.getFallbackCodes(i18next.options.fallbacks, code);
   *  console.log(fallbackCodes); // [&quot;en-US&quot;, &quot;en-GB&quot;, &quot;en&quot;]
   * 
   *  // 在上面的示例中，我们首先初始化了 i18next 库，设置了默认语言和后备语言等选项。然后定义了一个语言代码 code，表示要获取后备语言代码的语言代码。最后调用 getFallbackCodes 函数，传入后备语言代码定义和要获取后备语言代码的语言代码，获取后备语言代码列表。在这个例子中，后备语言代码列表为 [&quot;en-US&quot;, &quot;en-GB&quot;, &quot;en&quot;]，因为 code 的语言部分是 en，对应的后备语言代码定义为 [&quot;en-US&quot;, &quot;en-GB&quot;]，并且 en 也是默认的后备语言代码。
   */</span>
  <span class="token function">getFallbackCodes</span><span class="token punctuation">(</span><span class="token parameter">fallbacks<span class="token punctuation">,</span> code</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

  <span class="token doc-comment comment">/**
   * 用于获取给定语言代码的解析层次列表
   * 函数用于获取给定语言代码的解析层次列表。该函数接受两个参数：code 和 fallbackCode，其中 code 表示要获取解析层次列表的语言代码；fallbackCode 表示后备语言代码，如果未指定，则使用默认后备语言代码。具体实现如下：
   * 
   * 首先，根据传入的 fallbackCode 和默认后备语言代码，获取后备语言代码列表。
   * 
   * 然后，定义一个空数组 codes，用于存放语言代码列表。同时定义一个 addCode 函数，用于将语言代码添加到 codes 列表中。
   * 
   * 接下来，根据传入的 code 参数，依次尝试获取解析层次列表。具体来说，如果 code 是一个带有区域子标签的语言代码，依次尝试使用以下三种方法获取解析层次列表：
   * 
   * 使用 code 的格式化语言代码作为解析层次。
   * 如果 options.load 不是 languageOnly，使用 code 的脚本部分作为解析层次。
   * 如果 options.load 不是 currentOnly，使用 code 的语言部分作为解析层次。
   * 如果 code 是一个不带区域子标签的语言代码，直接使用 code 的格式化语言代码作为解析层次。
   * 
   * 接下来，依次将后备语言代码列表中的语言代码添加到 codes 列表中，如果语言代码已经存在，则不重复添加。
   * 
   * 最后，返回解析层次列表 codes。
   * // use demo 
   * import i18next from &#39;i18next&#39;;
   * 
   * i18next.init(<span class="token punctuation">{</span>
   * lng: &#39;en-US&#39;,
   * fallbackLng: &#39;en&#39;,
   * supportedLngs: [&#39;en&#39;, &#39;fr&#39;, &#39;es&#39;, &#39;zh&#39;],
   * <span class="token punctuation">}</span>);
   * 
   * const code = &#39;zh-CN&#39;;
   * const fallbackCode = &#39;zh&#39;;
   * const resolveHierarchy = i18next.toResolveHierarchy(code, fallbackCode);
   * console.log(resolveHierarchy); // [&quot;zh-CN&quot;, &quot;zh&quot;]
   * 
   * // 在上面的示例中，我们首先初始化了 i18next 库，设置了默认语言、后备语言和支持的语言列表等选项。然后定义了一个语言代码 code，表示要获取解析层次列表的语言代码，以及一个后备语言代码 fallbackCode。最后调用 toResolveHierarchy 函数，传入语言代码和后备语言代码，获取解析层次列表。在这个例子中，解析层次列表为 [&quot;zh-CN&quot;, &quot;zh&quot;]，因为 code 是 zh-CN，依次尝试使用 zh-CN、zh 作为解析层次，而 zh-CN 存在于支持的语言列表中，因此作为第一个解析层次，而 zh 不在支持的语言列表中，因此作为后备语言代码，作为第二个解析层次。
   */</span>
  <span class="token function">toResolveHierarchy</span><span class="token punctuation">(</span><span class="token parameter">code<span class="token punctuation">,</span> fallbackCode</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> LanguageUtil<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h6 id="什么是-解析层次列表" tabindex="-1"><a class="header-anchor" href="#什么是-解析层次列表" aria-hidden="true">#</a> 什么是 解析层次列表</h6><p>i18next 的解析层次列表是指根据给定的语言代码和后备语言代码，从更具体的到更一般的顺序，列出所有应该用来查找语言资源的语言代码列表。解析层次列表的顺序通常是按照以下顺序：</p><pre><code>  给定的语言代码本身
  给定语言代码的后备语言代码
  后备语言代码的后备语言代码
  默认后备语言代码
  例如，对于语言代码 en-US，默认的后备语言代码为 en，则其解析层次列表为：

  en-US
  en
  默认后备语言代码
  这意味着，在查找语言资源时，i18next 会先尝试使用 en-US 作为语言代码查找语言资源，如果找不到，则使用 en 作为语言代码查找语言资源，如果还找不到，则使用默认后备语言代码查找语言资源。如果在某个层次上找到了对应的语言资源，则不再继续查找其他层次。

  解析层次列表的作用在于，当某个语言资源不存在时，i18next 可以自动尝试使用后备语言代码查找语言资源，以提供更好的用户体验。通过定义不同的后备语言代码，可以增强应用程序的国际化和本地化能力。
</code></pre><h3 id="utils-js" tabindex="-1"><a class="header-anchor" href="#utils-js" aria-hidden="true">#</a> Utils.js</h3><p>提供了一些辅助方法，如浅复制、深复制、数组合并等。</p><h3 id="postprocessor-js" tabindex="-1"><a class="header-anchor" href="#postprocessor-js" aria-hidden="true">#</a> PostProcessor.js</h3><p>在翻译文本被插值或格式化之后对其进行进一步的处理的工具类。它可以用于对翻译结果进行后处理，例如添加额外的文本、转换文本格式等。</p><p>只有 addPostProcessor 和 handle 两个方法</p><ul><li>addPostProcessor：将后处理器模块添加到处理器列表</li><li>handle：使用指定的处理器处理给定的值</li></ul><p>demo</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// 导入必要的依赖</span>
<span class="token keyword">import</span> i18next <span class="token keyword">from</span> <span class="token string">&#39;i18next&#39;</span><span class="token punctuation">;</span>

<span class="token comment">// 自定义的PostProcessor类</span>
<span class="token keyword">class</span> <span class="token class-name">MyPostProcessor</span> <span class="token punctuation">{</span>
  <span class="token comment">// postProcess方法接收三个参数：value是翻译结果的字符串，key是翻译键，options是传递给翻译方法的选项对象</span>
  <span class="token function">postProcess</span><span class="token punctuation">(</span><span class="token parameter">value<span class="token punctuation">,</span> key<span class="token punctuation">,</span> options</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 在翻译结果后添加一段额外的文本</span>
    <span class="token keyword">return</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>value<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> - 这是额外的文本</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">// 将自定义的PostProcessor注册到i18next实例中</span>
i18next<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">MyPostProcessor</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 初始化i18next实例</span>
i18next<span class="token punctuation">.</span><span class="token function">init</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token comment">// 配置选项...</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 使用i18next进行翻译</span>
i18next<span class="token punctuation">.</span><span class="token function">t</span><span class="token punctuation">(</span><span class="token string">&#39;translationKey&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="formatter-js" tabindex="-1"><a class="header-anchor" href="#formatter-js" aria-hidden="true">#</a> Formatter.js</h3><p>用于对翻译文本进行格式化的工具类。它允许你定义自定义的格式化函数，以便在翻译文本中插入变量或进行其他格式化操作。</p><p>demo</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// 导入必要的依赖</span>
<span class="token keyword">import</span> i18next <span class="token keyword">from</span> <span class="token string">&#39;i18next&#39;</span><span class="token punctuation">;</span>

<span class="token comment">// 自定义的Formatter类</span>
<span class="token keyword">class</span> <span class="token class-name">MyFormatter</span> <span class="token punctuation">{</span>
  <span class="token comment">// format方法接收三个参数：value是翻译结果的字符串，format是格式化函数的名称，lng是当前的语言代码</span>
  <span class="token function">format</span><span class="token punctuation">(</span><span class="token parameter">value<span class="token punctuation">,</span> format<span class="token punctuation">,</span> lng</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 在这里根据format参数进行相应的格式化操作</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>format <span class="token operator">===</span> <span class="token string">&#39;uppercase&#39;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> value<span class="token punctuation">.</span><span class="token function">toUpperCase</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>format <span class="token operator">===</span> <span class="token string">&#39;lowercase&#39;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> value<span class="token punctuation">.</span><span class="token function">toLowerCase</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> value<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="backendconnector-js" tabindex="-1"><a class="header-anchor" href="#backendconnector-js" aria-hidden="true">#</a> BackendConnector.js</h3><p>用于连接 i18next 的后端和存储，以便在应用程序中进行国际化。将从远端加载的词条存储在内存中。</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">class</span> <span class="token class-name">Connector</span> <span class="token keyword">extends</span> <span class="token class-name">EventEmitter</span> <span class="token punctuation">{</span>
  <span class="token doc-comment comment">/**
   * 
   * <span class="token keyword">@param</span> <span class="token class-name"><span class="token punctuation">{</span><span class="token operator">*</span><span class="token punctuation">}</span></span> <span class="token parameter">backend</span> - 参数是用于加载和解析语言资源的后端。
   * <span class="token keyword">@param</span> <span class="token class-name"><span class="token punctuation">{</span><span class="token operator">*</span><span class="token punctuation">}</span></span> <span class="token parameter">store</span> - 参数是用于将语言资源存储在内存中以供后续使用的存储库。
   * <span class="token keyword">@param</span> <span class="token class-name"><span class="token punctuation">{</span><span class="token operator">*</span><span class="token punctuation">}</span></span> <span class="token parameter">services</span> - 参数是一组服务，它们提供了一些 i18next 功能的实现，例如事件处理和日志记录。
   * <span class="token keyword">@param</span> <span class="token class-name"><span class="token punctuation">{</span><span class="token operator">*</span><span class="token punctuation">}</span></span> <span class="token parameter">options</span> - 参数是一个可选对象，其中包含用于配置 Connector 实例的选项。
   */</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter">backend<span class="token punctuation">,</span> store<span class="token punctuation">,</span> services<span class="token punctuation">,</span> options <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

  <span class="token comment">// 加载队列</span>
  <span class="token function">queueLoad</span><span class="token punctuation">(</span><span class="token parameter">languages<span class="token punctuation">,</span> namespaces<span class="token punctuation">,</span> options<span class="token punctuation">,</span> callback</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

  <span class="token comment">// 从后端加载指定的语言资源，加载完成后调用回调函数</span>
  <span class="token function">loaded</span><span class="token punctuation">(</span><span class="token parameter">name<span class="token punctuation">,</span> err<span class="token punctuation">,</span> data</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

  <span class="token comment">// 预加载</span>
  <span class="token function">prepareLoading</span><span class="token punctuation">(</span><span class="token parameter">languages<span class="token punctuation">,</span> namespaces<span class="token punctuation">,</span> options <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> callback</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

  <span class="token comment">// 在存储库中创建一个新的条目来存储缺少的语言资源。</span>
  <span class="token function">saveMissing</span><span class="token punctuation">(</span>languages<span class="token punctuation">,</span> namespace<span class="token punctuation">,</span> key<span class="token punctuation">,</span> fallbackValue<span class="token punctuation">,</span> isUpdate<span class="token punctuation">,</span> options <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token function-variable function">clb</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> Connector<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="resourcestore-js" tabindex="-1"><a class="header-anchor" href="#resourcestore-js" aria-hidden="true">#</a> ResourceStore.js</h3><p>语言资源存储器，用于存储和管理不同语言的语言资源。主要的 API 包括 addResourceBundle() 和 getResource()。</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">class</span> <span class="token class-name">ResourceStore</span> <span class="token keyword">extends</span> <span class="token class-name">EventEmitter</span> <span class="token punctuation">{</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span>data<span class="token punctuation">,</span> options <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token literal-property property">ns</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&#39;translation&#39;</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token literal-property property">defaultNS</span><span class="token operator">:</span> <span class="token string">&#39;translation&#39;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

  <span class="token comment">// 添加命名空间</span>
  <span class="token function">addNamespaces</span><span class="token punctuation">(</span><span class="token parameter">ns</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

  <span class="token comment">// 移除命名空间</span>
  <span class="token function">removeNamespaces</span><span class="token punctuation">(</span><span class="token parameter">ns</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

  <span class="token comment">// 获取翻译资源</span>
  <span class="token function">getResource</span><span class="token punctuation">(</span><span class="token parameter">lng<span class="token punctuation">,</span> ns<span class="token punctuation">,</span> key<span class="token punctuation">,</span> options <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

  <span class="token doc-comment comment">/**
   * 添加单个翻译资源
   * 该函数会将 <span class="token punctuation">{</span> key: value <span class="token punctuation">}</span> 的形式的翻译资源添加到 this.store.data[lng][ns] 中。如果 options.silent 为 true，则不会抛出错误，而是返回错误信息。否则，如果添加翻译资源出现错误，则会抛出错误。
   * <span class="token keyword">@param</span> <span class="token class-name"><span class="token punctuation">{</span><span class="token operator">*</span><span class="token punctuation">}</span></span> <span class="token parameter">lng</span> 
   * <span class="token keyword">@param</span> <span class="token class-name"><span class="token punctuation">{</span><span class="token operator">*</span><span class="token punctuation">}</span></span> <span class="token parameter">ns</span> 
   * <span class="token keyword">@param</span> <span class="token class-name"><span class="token punctuation">{</span><span class="token operator">*</span><span class="token punctuation">}</span></span> <span class="token parameter">key</span> 翻译资源的键值 
   * <span class="token keyword">@param</span> <span class="token class-name"><span class="token punctuation">{</span><span class="token operator">*</span><span class="token punctuation">}</span></span> <span class="token parameter">value</span> 要添加的翻译资源的值 
   * <span class="token keyword">@param</span> <span class="token class-name"><span class="token punctuation">{</span><span class="token operator">*</span><span class="token punctuation">}</span></span> <span class="token parameter">options</span> 
   */</span>
  <span class="token function">addResource</span><span class="token punctuation">(</span><span class="token parameter">lng<span class="token punctuation">,</span> ns<span class="token punctuation">,</span> key<span class="token punctuation">,</span> value<span class="token punctuation">,</span> options <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token literal-property property">silent</span><span class="token operator">:</span> <span class="token boolean">false</span> <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

  <span class="token comment">// 添加多个翻译资源</span>
  <span class="token function">addResources</span><span class="token punctuation">(</span><span class="token parameter">lng<span class="token punctuation">,</span> ns<span class="token punctuation">,</span> resources<span class="token punctuation">,</span> options <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token literal-property property">silent</span><span class="token operator">:</span> <span class="token boolean">false</span> <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

  <span class="token doc-comment comment">/**
   * 添加翻译资源
   * <span class="token keyword">@param</span> <span class="token class-name"><span class="token punctuation">{</span><span class="token operator">*</span><span class="token punctuation">}</span></span> <span class="token parameter">lng</span> 语言 
   * <span class="token keyword">@param</span> <span class="token class-name"><span class="token punctuation">{</span><span class="token operator">*</span><span class="token punctuation">}</span></span> <span class="token parameter">ns</span> 命名空间 
   * <span class="token keyword">@param</span> <span class="token class-name"><span class="token punctuation">{</span><span class="token operator">*</span><span class="token punctuation">}</span></span> <span class="token parameter">resources</span> 翻译资源对象 
   * <span class="token keyword">@param</span> <span class="token class-name"><span class="token punctuation">{</span><span class="token operator">*</span><span class="token punctuation">}</span></span> <span class="token parameter">deep</span> 是否深度覆盖已有的翻译资源对象 
   * <span class="token keyword">@param</span> <span class="token class-name"><span class="token punctuation">{</span><span class="token operator">*</span><span class="token punctuation">}</span></span> <span class="token parameter">overwrite</span> 是否覆盖已有的翻译资源 
   * <span class="token keyword">@param</span> <span class="token class-name"><span class="token punctuation">{</span><span class="token operator">*</span><span class="token punctuation">}</span></span> <span class="token parameter">options</span> 
   */</span>
  <span class="token function">addResourceBundle</span><span class="token punctuation">(</span><span class="token parameter">lng<span class="token punctuation">,</span> ns<span class="token punctuation">,</span> resources<span class="token punctuation">,</span> deep<span class="token punctuation">,</span> overwrite<span class="token punctuation">,</span> options <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token literal-property property">silent</span><span class="token operator">:</span> <span class="token boolean">false</span> <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

  <span class="token comment">// 删除指定语言和命名空间的所有翻译资源</span>
  <span class="token function">removeResourceBundle</span><span class="token punctuation">(</span><span class="token parameter">lng<span class="token punctuation">,</span> ns</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

  <span class="token comment">// 判断指定语言和命名空间下是否有翻译资源</span>
  <span class="token function">hasResourceBundle</span><span class="token punctuation">(</span><span class="token parameter">lng<span class="token punctuation">,</span> ns</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

  <span class="token comment">// 获取指定语言和命名空间的所有翻译资源</span>
  <span class="token function">getResourceBundle</span><span class="token punctuation">(</span><span class="token parameter">lng<span class="token punctuation">,</span> ns</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

  <span class="token comment">// 获取指定语言下所有命名空间的翻译资源</span>
  <span class="token function">getDataByLanguage</span><span class="token punctuation">(</span><span class="token parameter">lng</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

  <span class="token comment">// 判断指定语言下是否有翻译资源</span>
  <span class="token function">hasLanguageSomeTranslations</span><span class="token punctuation">(</span><span class="token parameter">lng</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
  <span class="token comment">// 需要序列化的实例数据</span>
  <span class="token function">toJSON</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> ResourceStore<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="eventemitter-js" tabindex="-1"><a class="header-anchor" href="#eventemitter-js" aria-hidden="true">#</a> EventEmitter.js</h3><p>EventEmitter是一个发布订阅者模式的封装，是前端环境中很常见的On，Emit结构。</p><p>从这个设计来说，I18next是不想依赖于浏览器端的dom和event。所以自己引入了一个EventEmitter类。这个类和其他的框架中的一些EventEmitter没有太大的区别。</p><p>因为不依赖于具体环境的On Emit设计。i18next的适应范围不限于前端环境。通过不同插件的组合，可以适应于前端和后端代码。</p><h2 id="i18next-初始化参数词典" tabindex="-1"><a class="header-anchor" href="#i18next-初始化参数词典" aria-hidden="true">#</a> I18next 初始化参数词典</h2><h3 id="init-params" tabindex="-1"><a class="header-anchor" href="#init-params" aria-hidden="true">#</a> init params</h3><ul><li>lng：默认语言代码，表示应用程序的当前语言。默认值为 &#39;en&#39;。</li><li>fallbackLng：默认后备语言代码，表示当当前语言找不到对应的语言资源时，应该使用哪个语言作为后备语言。可以使用字符串、数组或一个函数来定义后备语言代码。默认值为 &#39;dev&#39;。</li><li>fallbackNS：默认后备命名空间，表示当当前命名空间找不到对应的语言资源时，应该使用哪个命名空间作为后备命名空间。可以使用字符串、数组或一个函数来定义后备命名空间。默认值为 false。</li><li>defaultNS：默认命名空间，表示应用程序默认使用的命名空间。默认值为 &#39;translation&#39;。</li><li>resources：语言资源对象，用于指定应用程序支持的语言和其对应的语言资源。可以是一个对象，也可以是一个函数。默认值为 undefined。</li><li>ns：命名空间列表，用于指定应用程序支持的命名空间。可以是一个字符串或字符串数组。默认值为 [defaultNS]。</li><li>defaultNS：默认命名空间，表示应用程序默认使用的命名空间。默认值为 &#39;translation&#39;。</li><li>fallbackNS：默认后备命名空间，表示当当前命名空间找不到对应的语言资源时，应该使用哪个命名空间作为后备命名空间。可以使用字符串、数组或一个函数来定义后备命名空间。默认值为 false。</li><li>debug：是否启用调试模式。如果设置为 true，则会输出调试信息。默认值为 false。</li><li>preload：是否预加载语言资源。如果设置为 true，则会在初始化时自动加载所有语言资源。如果设置为 &#39;current&#39;，则只会加载当前语言的语言资源。默认值为 false。</li><li>keySeparator：命名空间和键之间的分隔符。默认值为 &#39;.&#39;。</li><li>nsSeparator：命名空间之间的分隔符。默认值为 &#39;:&#39;。</li><li>pluralSeparator：复数形式关键字和数量之间的分隔符。默认值为 &#39;_&#39;。</li><li>contextSeparator：上下文关键字和键之间的分隔符。默认值为 &#39;_&#39;。</li><li>interpolation：变量插值选项，用于指定变量插值的开始和结束标记。默认值为 {}。</li><li>returnNull：是否返回 null，如果找不到对应的语言资源。如果设置为 true，则会返回 null。默认值为 false。</li><li>returnEmptyString：是否返回空字符串，如果找不到对应的语言资源。如果设置为 true，则会返回空字符串。默认值为 false。</li><li>returnObjects：是否返回对象，如果找不到对应的语言资源。如果设置为 true，则会返回一个包含键和命名空间的对象。默认值为 false。</li><li>joinArrays：是否将多个翻译结果合并为一个字符串。如果设置为 true，则会将多个翻译结果用逗号分隔并合并为一个字符串。默认值为 false。</li><li>partialBundledLanguages：是否启用部分加载语言资源。如果启用，将只加载应用程序需要的语言资源，而不是全部加载。默认值为 false。</li><li>saveMissing：是否记录缺失的翻译。如果设置为 true，则会记录缺失的翻译，并在下一次加载相应的语言资源时进行更新。默认值为 false。</li><li>missingKeyHandler：缺失翻译的处理程序，可以是一个函数或一个字符串。如果是一个函数，则会在缺失翻译时调用该函数，传入缺失的键和命名空间。如果是一个字符串，则会作为一个 URL，用于将缺失的翻译发送到服务器进行记录或处理。默认值为 undefined。</li><li>parseMissingKeyHandler：解析缺失翻译的处理程序，可以是一个函数或一个字符串。如果是一个函数，则会在解析缺失翻译时调用该函数，传入缺失的键和命名空间。如果是一个字符串，则会作为一个 URL，用于将解析缺失的翻译发送到服务器进行记录或处理。默认值为 undefined。</li><li>appendNamespaceToMissingKey：是否在缺失翻译时添加命名空间前缀。如果设置为 true，则会在缺失的翻译键前添加命名空间前缀。默认值为 false。</li><li>appendNamespaceToCIMode：是否在 CI 模式下添加命名空间前缀。如果设置为 true，则会在 CI 模式下添加命名空间前缀。默认值为 false。</li><li>postProcess：后处理选项，用于指定后处理函数或后处理函数数组。后处理函数用于对翻译结果进行额外处理，例如格式化、修改等等。默认值为 undefined。</li><li>postProcessPassResolved：是否将解析后的值传递给后处理函数。如果设置为 true，则会将解析后的值传递给后处理函数。默认值为 false。</li><li>preprocess：预处理选项，用于指定预处理函数或预处理函数数组。预处理函数用于在翻译之前对键和值进行额外处理，例如转换大小写、转义字符等等。默认值为 undefined。</li><li>detection：语言检测选项，用于指定语言检测器。可以是一个对象或一个函数。默认值为 {}。</li><li>backend：后端选项，用于指定后端。可以是一个对象或一个数组。默认值为 undefined。</li><li>cache：缓存选项，用于指定缓存机制。可以是一个对象或一个数组。默认值为 undefined。</li><li>editor：编辑器选项，用于指定编辑器配置。可以是一个对象或一个数组。默认值为 undefined。</li><li>initImmediate：是否立即初始化 i18next 库。如果设置为 true，则会立即初始化 i18next 库。如果设置为 false，则需要手动调用 i18next.init 函数来初始化 i18next 库。默认值为 true。</li></ul><h3 id="backend" tabindex="-1"><a class="header-anchor" href="#backend" aria-hidden="true">#</a> backend</h3><p>i18next 的 backend（后端）是指用于加载和存储语言资源的一种组件或插件。i18next 库本身不包含任何加载和存储语言资源的功能，而是通过 backend 来实现这些功能。backend 可以是一个 npm 模块或一个自定义模块，可以通过 i18next 的 use 方法来注册和使用。</p><p>i18next 支持多种类型的 backend，包括：</p><ul><li>i18next-fs-backend：使用文件系统来加载和存储语言资源。</li><li>i18next-xhr-backend：使用 AJAX 请求来加载和存储语言资源。</li><li>i18next-http-backend：使用 HTTP 请求来加载和存储语言资源。</li><li>i18next-localstorage-backend：使用浏览器本地存储来存储语言资源。</li><li>i18next-chained-backend：将多个 backend 链接在一起，以实现多级缓存和备份策略。</li><li>i18next-cache-backend：使用内存缓存来加载和存储语言资源。</li><li>i18next-sprintf-postprocessor：使用 sprintf 函数来格式化变量插值。</li></ul><p>使用 backend 可以方便地将语言资源存储在不同的位置，并且能够根据需要进行动态加载和缓存。例如，可以将语言资源存储在远程服务器上，使用 AJAX 请求进行加载，也可以将语言资源存储在本地浏览器中，使用浏览器本地存储进行缓存。同时，i18next 还支持多级缓存和备份策略，以确保语言资源的可靠性和可用性。</p><h3 id="this-services" tabindex="-1"><a class="header-anchor" href="#this-services" aria-hidden="true">#</a> this.services</h3><p>this.services 是 i18next 库内部用来存储各种服务的对象。例如，i18next.init 方法会将各种服务（如 BackendService、LanguageUtils、Logger 等）存储在 this.services 中，以便在后续的操作中使用这些服务。</p><p>this.services 可以被视为 i18next 库的“底层”，它提供了各种服务来支持翻译资源的加载、解析、管理和输出。在使用 i18next 库时，通常不需要直接操作 this.services，而是通过 i18next 提供的各种方法来访问这些服务。但是，如果需要扩展 i18next 库的功能或自定义某些行为，可以通过操作 this.services 来实现。</p><p>在 i18next 库中，this.services 包含以下服务：</p><ul><li>i18nFormat：负责格式化翻译资源中的变量和占位符。</li><li>interpolator：负责解析翻译资源中的插值表达式。</li><li>backendConnector：负责与后端服务交互以加载翻译资源。</li><li>backend：与 backendConnector 配合使用，负责实际加载翻译资源。</li><li>cache：负责缓存已加载的翻译资源。</li><li>languageUtils：提供一些工具方法，用来处理语言标签和区域设置。</li><li>pluralResolver：负责根据语言标签和数量计算复数形式。</li><li>resourceStore：负责管理翻译资源。</li><li>resourceStoreData：与 resourceStore 配合使用，表示翻译资源的内部数据结构。</li><li>toMomentFormat：负责将 Moment.js 的日期格式转换为 i18next 的日期格式。</li><li>logger：负责记录日志。</li></ul></div><!--[--><!--]--></div><footer class="page-meta"><!----><div class="meta-item last-updated"><span class="meta-item-label">Last Updated: </span><!----></div><!----></footer><!----><!--[--><!--]--></main><!--]--></div><!----><!--]--></div>
    <script type="module" src="/blog/assets/app.c4af5a84.js" defer></script>
  </body>
</html>
